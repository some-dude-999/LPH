=== SpanishWordsViewer.txt ===
PROJECT: LPH - Spanish Language Learning Platform
COMPONENT: Interactive Spanish Vocabulary Pack Viewer with Analytics
CREATED: 2025-11-19
LAST UPDATED: 2025-11-20 - Added act color coding and continuous act checker to ensure proper progression

DATA SOURCES:
- CSV Files (Local): 251 CSV files in the SpanishWords directory
  * SpanishWordsOverview.csv - Master index with pack metadata (Pack_Number, Pack_Title, Difficulty_Act, Spanish_Words, auto_word_count, manual_base_word_count, auto_base_word_checker)
  * SpanishWords1.csv through SpanishWords250.csv - Individual vocabulary packs
- File Structure:
  * Overview CSV: Pack_Number, Pack_Title, Difficulty_Act, Spanish_Words (array), auto_word_count, manual_base_word_count, auto_base_word_checker
  * Pack CSV: spanish, english, chinese, pinyin, portuguese
  * Each pack contains 24-45 translation entries (must be divisible by 3)
  * Total: ~10,685 vocabulary entries across all packs
  * Difficulty Acts: Act I through Act VII representing progressive difficulty levels

FUNCTIONALITY:
- Main Purpose: Browse and study all 250 Spanish vocabulary packs with multi-language translations, data validation, visual analytics, and act progression tracking
- Key Functions:
  * populateDropdown() - Generates 251 options (1 overview + 250 packs)
  * parseCSV(text) - Converts CSV text into structured data
  * parseCSVLine(line) - Handles quoted fields, commas, and escaped quotes
  * createTable(headers, rows, isOverview, continuityErrors) - Generates HTML table with conditional formatting, act color coding, and column toggles
  * loadCSV(filename) - Fetches and displays selected CSV file
  * updateInfoBar(packName, wordCount) - Shows pack statistics
  * escapeHtml(text) - Prevents XSS attacks
  * getActNumber(actString) - Extracts numeric act value from act string (e.g., "Act I: Foundation" ‚Üí 1)
  * romanize(num) - Converts numbers to Roman numerals (1 ‚Üí I, 2 ‚Üí II, etc.)
  * checkActContinuity(rows) - Validates that acts progress continuously without jumping backward
  * calculateOverviewStats(rows) - Computes totals, detects discrepancies, and validates act continuity across all packs
  * calculatePackStats(rows) - Validates individual pack word counts
  * renderStatsSummary(stats, isOverview) - Displays comprehensive statistics with discrepancy and continuity alerts
  * createOverviewChart(rows) - Generates Chart.js histogram (bar chart) grouping packs by base word count ranges in increments of 2
  * toggleCharts() - Shows/hides data visualization charts
  * toggleColumn(columnIndex) - Hides/shows individual table columns
- Event Handlers:
  * DOMContentLoaded - Initializes app and loads overview
  * Dropdown change - Loads selected pack
  * Column checkbox toggle - Shows/hides columns
  * Show Charts button - Toggles chart visibility
- NEW Display Features (2025-11-20):
  * ‚úÖ Act Color Coding - Each row is color-coded by difficulty act (7 distinct colors):
    - Act I: Light Blue (#e3f2fd with blue left border)
    - Act II: Light Purple (#f3e5f5 with purple left border)
    - Act III: Light Green (#e8f5e9 with green left border)
    - Act IV: Light Orange (#fff3e0 with orange left border)
    - Act V: Light Pink (#fce4ec with pink left border)
    - Act VI: Light Yellow (#fff9c4 with yellow left border)
    - Act VII: Light Red (#ffebee with red left border)
  * ‚úÖ Act Legend - Visual legend showing all act colors above the overview table
  * ‚úÖ Continuous Act Checker - Validates that acts progress sequentially without jumping backward:
    - Detects when a word pack jumps to a lower act (e.g., Act II ‚Üí Act I)
    - Highlights continuity errors with pulsing red border animation
    - Displays detailed error messages in continuity alert section
    - New stat card showing "Act Continuity" status (CONTINUOUS or ERRORS FOUND)
  * ‚úÖ Column Toggle Checkboxes (üëÅÔ∏è icon) - Hide/show columns to manage long word lists
  * ‚úÖ Statistics Summary Section - Shows totals and validation status at a glance
  * ‚úÖ Conditional Color Formatting:
    - GREEN (count-match): Values that match expected calculations
    - RED (count-mismatch): Discrepancies detected (auto_word_count ‚â† manual_base_word_count √ó 3)
  * ‚úÖ Discrepancy Detection - Automatic validation that auto_word_count === manual_base_word_count √ó 3
  * ‚úÖ Visual Alerts:
    - Yellow background: Discrepancies found
    - Green background: All packs valid
    - Red alert box: Act continuity errors found
  * ‚úÖ Chart Visualization (Chart.js):
    - Histogram (bar chart) showing distribution of packs by base word count ranges
    - Ranges grouped in increments of 2 (starting from minimum base word count)
    - High-resolution view for detailed distribution analysis
    - Y-axis shows number of packs, X-axis shows base word count ranges
    - Tooltips display count and percentage
    - Toggle on/off with "Show Charts" button
- Previous Display Features:
  * Sticky table headers for easy scrolling
  * Alternating row colors for readability
  * Hover effects on table rows
  * Loading spinner during fetch
  * Error messages for missing files
  * Responsive design for mobile devices

DEPENDENCIES:
- External Libraries: Chart.js v3+ (CDN: https://cdn.jsdelivr.net/npm/chart.js)
- Project Files:
  * SpanishWordsOverview.csv (required)
  * SpanishWords1.csv through SpanishWords250.csv (required)
  * All must follow the format rules in "000 SPANISH TRANSLATION FORMAT RULES.txt"
- APIs Required: None (uses Fetch API for local files)

INTEGRATION:
- Receives data from: Local CSV files in SpanishWords directory
- Sends data to: None (read-only viewer)
- Triggers: User dropdown selection
- Related Components:
  * CsvViewerForManuallyBuildingCSV.html - Used to create the source CSV files
  * 000 SPANISH TRANSLATION FORMAT RULES.txt - Defines data structure requirements
  * SpanishWordsPythonHelperScripts/ - Validates CSV data integrity

CORRECTIONS & CLARIFICATIONS:
- Initially thought: Simple table viewer without validation
- Actually: Full-featured analytics tool with data validation, conditional formatting, and visualization
- Why this matters: Now catches data quality issues immediately with visual indicators, making it easy to spot packs that need correction
- Initially thought: Files might be fetched from an external server
- Actually: Uses client-side Fetch API to load local CSV files from same directory
- Why this matters: Requires proper file paths when deployed; BASE_PATH variable may need adjustment for GitHub Pages vs local testing

NOTES:
- BASE_PATH constant set to './' - adjust for different deployment environments
- TOTAL_PACKS constant set to 250 - update if more packs are added
- Overview table has special styling for the third column (pack arrays in monospace)
- Works offline once files are loaded
- File naming convention must be exact: SpanishWords[1-250].csv
- CSV parsing handles edge cases:
  * Quoted fields with commas inside
  * Escaped quotes (double quotes)
  * Empty lines are filtered out
- NEW FEATURES ADDED (2025-11-20):
  * Difficulty_Act column added to overview for game progression (Act I through Act VII)
  * Act color coding system implemented with 7 distinct colors for visual differentiation
  * Continuous act checker validates sequential progression (prevents Act II ‚Üí Act I jumps)
  * Act legend displays all available acts and their colors
  * Continuity errors highlighted with pulsing red border animation
  * Act Continuity stat card added to summary section
- FEATURES ADDED (2025-11-19):
  * Column visibility toggles solve the problem of overly wide tables
  * Statistics section provides instant validation feedback
  * Green/red color coding makes discrepancies immediately visible
  * Histogram visualization uses increment of 2 for high-resolution distribution analysis, starting from lowest base word count
  * Total base words and total words are calculated and displayed for both individual packs and overview
  * Expected word count (base words √ó 3) is shown and validated
- Data Validation Rules:
  * For Overview: auto_word_count should equal manual_base_word_count √ó 3
  * For Overview: auto_word_count should equal auto_base_word_checker
  * For Individual Packs: Total words should be divisible by 3 (each base word has 3 examples)
  * For Overview: Acts must progress continuously without jumping backward (Act I ‚Üí Act II ‚Üí Act III, NOT Act I ‚Üí Act II ‚Üí Act I)
  * Invalid act designations are flagged (missing or malformed act strings)
- Future improvements could include:
  * Search/filter functionality
  * Flashcard mode for studying
  * Progress tracking (mark words as learned)
  * Audio pronunciation integration
  * Random word quiz generator
  * Export selected words to study list
  * Dark mode toggle
  * Download discrepancy report as CSV
  * Sort packs by word count or discrepancy status
===
