<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wordpack Data Structure Debugger</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
  <script src="../wordpack-logic.js"></script>
  <link rel="stylesheet" href="./DecoderTest.css">
</head>
<body>

  <div class="decoder-header">
    <h1>Wordpack Data Structure Debugger</h1>
    <div class="header-controls">
      <div class="control-group">
        <label>Target Language</label>
        <div id="languageRadios" style="display: flex; gap: 10px; margin-top: 5px;">
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="Spanish" checked> Spanish
          </label>
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="Chinese"> Chinese
          </label>
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="English"> English
          </label>
        </div>
      </div>

      <div class="control-group">
        <label for="actSelect">Act</label>
        <select id="actSelect"></select>
      </div>

      <div class="control-group">
        <label for="packSelect">Wordpack</label>
        <select id="packSelect"></select>
      </div>

      <div class="control-group">
        <label for="nativeLanguageSelect">I Speak</label>
        <select id="nativeLanguageSelect"></select>
      </div>
    </div>

    <div class="mode-selector">
      <label><input type="radio" name="viewMode" value="table" checked> Table</label>
      <label><input type="radio" name="viewMode" value="multipleChoice"> Multiple Choice</label>
      <label><input type="radio" name="viewMode" value="typing"> Typing</label>
      <label><input type="radio" name="viewMode" value="pronunciation"> Pronunciation</label>
      <label><input type="radio" name="viewMode" value="flashcard"> Flashcard</label>
    </div>
  </div>

  <div class="content-container">
    <h2>Vocabulary Table</h2>
    <p><strong>Pack Title:</strong> <span id="packTitle">Select a wordpack to view</span></p>

    <p id="edgeCaseFilterContainer" style="display: none;">
      <label>
        <input type="checkbox" id="showEdgeCasesOnly">
        <strong>Show Edge Cases & Mismatches</strong> (Latin abbreviations + pinyin errors)
      </label>
    </p>

    <div id="flashcardArea" style="display: none; margin: 20px 0; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
      <h3>Flashcard Demo (Anti-Decoupling Principle)</h3>
      <p><em>Front and back are properties of the SAME card object - they can never get out of sync.</em></p>

      <div id="flashcardDisplay" style="border: 3px solid #666; padding: 40px; margin: 20px 0; text-align: center; min-height: 150px; background: white; cursor: pointer;" onclick="window.flipCard()">
        <div id="flashcardContent" style="font-size: 24px;">Click to start</div>
        <div id="flashcardSide" style="font-size: 12px; color: #999; margin-top: 10px;">(click card to flip)</div>
      </div>

      <div style="text-align: center;">
        <button onclick="window.prevCard()" style="padding: 10px 20px; margin: 5px;">‚Üê Previous</button>
        <button onclick="window.flipCard()" style="padding: 10px 20px; margin: 5px;">Flip Card</button>
        <button onclick="window.nextCard()" style="padding: 10px 20px; margin: 5px;">Next ‚Üí</button>
        <button onclick="window.shuffleDeck()" style="padding: 10px 20px; margin: 5px;">üîÄ Shuffle</button>
      </div>

      <p id="flashcardCounter" style="text-align: center; margin-top: 10px;">Card 0 of 0</p>

      <details style="margin-top: 20px;">
        <summary style="cursor: pointer; font-weight: bold;">üîç View Current Card Object (Anti-Decoupling Proof)</summary>
        <pre id="flashcardDebug" style="background: #eee; padding: 10px; overflow-x: auto; font-size: 12px;">// No card loaded yet</pre>
        <p style="font-size: 12px; color: #666;">
          ‚Üë Notice: <code>front</code> and <code>back</code> are properties of the SAME object.
        </p>
      </details>
    </div>

    <table border="1" cellpadding="8" cellspacing="0">
      <thead>
        <tr id="tableHeaderRow">
          <th id="col1Header">I am learning</th>
          <th id="col2Header">I speak</th>
        </tr>
      </thead>
      <tbody id="vocabularyTable">
        <tr>
          <td colspan="2">Loading data...</td>
        </tr>
      </tbody>
    </table>

    <hr>

    <h2>6. Debug Information</h2>
    <pre id="debugInfo">Initializing...</pre>

    <script type="module" src="./DecoderTest.js"></script>
  </div>

</body>
</html>
