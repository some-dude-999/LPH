<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who Even Learns Languages Dude</title>

    <!-- ============================================================
         PROGRAM: Language Learner Demographics Visualizer
         Core Purpose: Show who learns Spanish, English, and Chinese using interactive charts
         ============================================================

         WHAT THIS PROGRAM DOES:
         -----------------------
         - Visualizes global distribution of native languages among language learners
         - Displays data for three target languages: Spanish, English, Chinese
         - Presents three data perspectives for each language:
           * Duolingo Data: Native language breakdown from Duolingo user base
           * Geographic Data: Country/region breakdown of learners
           * Estimated Data: Combined estimates from multiple sources
         - Uses interactive pie charts (Chart.js) to show percentages
         - Shows contextual statistics and data sources for transparency
         - Responsive tabbed interface for easy exploration

         HOW IT WORKS:
         -------------
         - User selects main language tab (Spanish/English/Chinese)
         - User selects data source sub-tab (Duolingo/Geographic/Estimated)
         - Chart.js renders pie chart from hardcoded data arrays
         - Statistics grid shows key facts and numbers
         - Sources section lists data provenance for verification
         - All charts pre-rendered on page load for instant switching
         - Tab switching shows/hides content with CSS classes

         KEY FEATURES:
         -------------
         1. Three-Tier Tab System: Main language tabs + sub-tabs for data sources
         2. Nine Pre-Rendered Charts: All charts loaded at once for smooth UX
         3. Multiple Data Perspectives: Compare Duolingo, geographic, and estimated distributions
         4. Source Attribution: Every dataset includes sources for credibility
         5. Color-Coded Stats: Spanish=red, English=blue, Chinese=orange for visual consistency
         6. Responsive Design: Works on all screen sizes with flexible grid layout
         7. Smooth Animations: Fade-in effect on page load

         USAGE:
         ------
         1. Click main language tab (Spanish, English, or Chinese)
         2. Click sub-tab to switch data source (Duolingo, Geographic, or Estimated)
         3. Review pie chart showing native language distribution
         4. Read statistics cards for key insights
         5. Check sources section for data provenance
         6. Compare across languages and data sources

         DATA SOURCES:
         -------------
         This program aggregates data from:
         - Duolingo Language Reports (official learner statistics)
         - Babbel geographic analysis
         - British Council, Keats School, CGTN (Chinese learners)
         - Confucius Institute data
         - Various educational research sources

         DESIGN RATIONALE:
         -----------------
         Why three data perspectives?
         - Duolingo data = self-reported native language (behavioral)
         - Geographic data = where learners are located (regional)
         - Estimated data = weighted combination adjusting for demographics

         Example: Spanish learners
         - Duolingo shows 42% English speakers (global platform)
         - Geographic shows 45% USA (regional concentration)
         - Estimated shows 50% English (accounting for USA = 85% English-speaking)

         ============================================================ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ============================================================
           DESIGN SYSTEM
           ============================================================
           Modern, vibrant UI with purple gradient background.
           Design priorities:
           - Visual hierarchy: Clear tabs, prominent charts, supporting stats
           - Color coding: Red=Spanish, Blue=English, Orange=Chinese
           - Smooth interactions: Tab switching, hover effects, animations
           - Professional polish: Shadows, rounded corners, gradient accents
           ============================================================ */

        /* ============================================================
           SECTION: Base Layout
           ============================================================
           Purple gradient background creates engaging, modern feel.
           Flexbox centers white content card vertically and horizontally.
           Full viewport height ensures content is always centered.
           ============================================================ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); /* Purple gradient */
            margin: 0;
            padding: 20px;
            min-height: 100vh; /* Full viewport height */
            display: flex;
            flex-direction: column;
            align-items: center; /* Center horizontally */
            justify-content: center; /* Center vertically */
        }

        /* ============================================================
           SECTION: Main Content Container
           ============================================================
           White card with rounded corners floats on gradient background.
           Large shadow creates depth and visual separation.
           Max-width ensures readable line lengths on large screens.
           ============================================================ */
        .container {
            background: white;
            border-radius: 20px; /* Soft rounded corners */
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); /* Deep shadow for depth */
            max-width: 950px;
            width: 100%;
            text-align: center;
        }

        /* ============================================================
           SECTION: Headers
           ============================================================
           Large h1 establishes visual hierarchy.
           Subtitle provides context in muted gray.
           ============================================================ */
        h1 {
            color: #2c3e50; /* Dark gray for strong contrast */
            margin-bottom: 10px;
            font-size: 2.5em; /* Large for impact */
        }

        .subtitle {
            color: #7f8c8d; /* Muted gray for secondary text */
            margin-bottom: 25px;
            font-size: 1.1em;
        }

        /* ============================================================
           SECTION: Main Language Tabs (Spanish/English/Chinese)
           ============================================================
           Horizontal tab bar with bottom border indicators.
           Active tab has purple underline matching gradient theme.
           Smooth transitions on hover and click.
           ============================================================ */
        .main-tabs {
            display: flex;
            justify-content: center; /* Center tabs horizontally */
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ecf0f1; /* Subtle divider */
        }

        .main-tab {
            padding: 15px 30px;
            cursor: pointer;
            background: none; /* Transparent background */
            border: none;
            border-bottom: 3px solid transparent; /* Hidden by default */
            font-size: 1.1em;
            font-weight: 600;
            color: #7f8c8d; /* Gray when inactive */
            transition: all 0.3s ease; /* Smooth color/border change */
        }

        .main-tab:hover {
            color: #667eea; /* Purple on hover */
        }

        .main-tab.active {
            color: #667eea; /* Purple when active */
            border-bottom-color: #667eea; /* Purple underline */
        }

        /* ============================================================
           SECTION: Sub Data Source Tabs (Duolingo/Geographic/Estimated)
           ============================================================
           Secondary tab system for data source selection.
           Pills with borders that fill with purple when active.
           Background is light gray to separate from main tabs.
           ============================================================ */
        .sub-tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 25px;
            padding: 10px 0;
            background: #f8f9fa; /* Light gray background */
            border-radius: 10px;
        }

        .sub-tab {
            padding: 10px 20px;
            cursor: pointer;
            background: white;
            border: 2px solid #ecf0f1; /* Light gray border */
            border-radius: 8px; /* Pill shape */
            font-size: 0.95em;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }

        .sub-tab:hover {
            border-color: #667eea; /* Purple border on hover */
            color: #667eea;
        }

        .sub-tab.active {
            background: #667eea; /* Filled purple when active */
            color: white;
            border-color: #667eea;
        }

        /* ============================================================
           SECTION: Content Visibility (Tab System Logic)
           ============================================================
           CSS-based tab switching using .active class.
           Only one language-content and one data-content visible at a time.
           JavaScript toggles .active class to show/hide panels.
           ============================================================ */
        .language-content {
            display: none; /* Hidden by default */
        }

        .language-content.active {
            display: block; /* Shown when active */
        }

        .data-content {
            display: none; /* Hidden by default */
        }

        .data-content.active {
            display: block; /* Shown when active */
        }

        /* ============================================================
           SECTION: Chart Container
           ============================================================
           Fixed height container for Chart.js pie charts.
           Relative positioning allows Chart.js to size properly.
           Margin provides spacing above and below charts.
           ============================================================ */
        .chart-container {
            position: relative;
            height: 400px; /* Fixed height for consistent chart sizing */
            margin: 30px auto;
        }

        /* ============================================================
           SECTION: Statistics Grid (KEY FEATURE)
           ============================================================
           Responsive grid displays key facts below each chart.
           Auto-fit ensures cards wrap on smaller screens.
           Color-coded accent bars match language identity:
           - Spanish = Red (#e74c3c)
           - English = Blue (#3498db)
           - Chinese = Orange (#e67e22)
           ============================================================ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Responsive wrapping */
            gap: 15px;
            margin-top: 30px;
        }

        .stat-item {
            background: #f8f9fa; /* Light gray background */
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #e74c3c; /* Default to Spanish red */
        }

        /* Color-coded left borders for language identity */
        .stat-item.spanish {
            border-left-color: #e74c3c; /* Red */
        }

        .stat-item.english {
            border-left-color: #3498db; /* Blue */
        }

        .stat-item.chinese {
            border-left-color: #e67e22; /* Orange */
        }

        /* Large numbers draw attention to key metrics */
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
        }

        /* Color-coded numbers match border colors */
        .stat-item.spanish .stat-number {
            color: #e74c3c; /* Red */
        }

        .stat-item.english .stat-number {
            color: #3498db; /* Blue */
        }

        .stat-item.chinese .stat-number {
            color: #e67e22; /* Orange */
        }

        /* Muted label text for context */
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        /* ============================================================
           SECTION: Data Sources Section
           ============================================================
           Small gray text at bottom lists data provenance.
           Left-aligned for easier reading of source citations.
           Separated from stats by thin top border.
           ============================================================ */
        .sources {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1; /* Divider line */
            font-size: 0.85em; /* Smaller text for secondary info */
            color: #95a5a6; /* Light gray for subtle appearance */
            text-align: left; /* Left-align for readability */
        }

        .sources p {
            margin: 5px 0; /* Tight spacing for source list */
        }

        /* ============================================================
           SECTION: Data Badge (Currently Unused)
           ============================================================
           Purple pill badge for future use (e.g., marking data freshness).
           Matches purple gradient theme.
           ============================================================ */
        .data-badge {
            display: inline-block;
            padding: 4px 12px;
            background: #667eea; /* Purple to match theme */
            color: white;
            border-radius: 12px; /* Pill shape */
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 10px;
            vertical-align: middle;
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="container">
        <h1>üåç Who Even Learns Languages Dude</h1>
        <p class="subtitle">Global distribution of native languages among language learners (3 data perspectives)</p>

        <!-- Main Language Tabs -->
        <div class="main-tabs">
            <button class="main-tab active" onclick="showLanguage('spanish')">üá™üá∏ Spanish</button>
            <button class="main-tab" onclick="showLanguage('english')">üá¨üáß English</button>
            <button class="main-tab" onclick="showLanguage('chinese')">üá®üá≥ Chinese</button>
        </div>

        <!-- SPANISH CONTENT -->
        <div id="spanish-lang" class="language-content active">
            <!-- Sub Tabs for Data Sources -->
            <div class="sub-tabs">
                <button class="sub-tab active" onclick="showDataSource('spanish', 'duolingo')">üìä Duolingo Data</button>
                <button class="sub-tab" onclick="showDataSource('spanish', 'geographic')">üåé Geographic</button>
                <button class="sub-tab" onclick="showDataSource('spanish', 'estimated')">üîÆ Estimated</button>
            </div>

            <!-- Duolingo Data -->
            <div id="spanish-duolingo" class="data-content active">
                <div class="chart-container">
                    <canvas id="spanishDuolingoChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item spanish">
                        <div class="stat-number">24M+</div>
                        <div class="stat-label">Total Spanish Learners Worldwide</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">70%</div>
                        <div class="stat-label">US K-12 Students Choose Spanish</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">36%</div>
                        <div class="stat-label">US Adults Attempting Spanish</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">11%</div>
                        <div class="stat-label">UK Bilinguals Learn Spanish</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Duolingo):</strong></p>
                    <p>Mango Languages, NBC News, UT Permian Basin, Test Prep Insight, Speakeasy BCN, Preply</p>
                </div>
            </div>

            <!-- Geographic Data -->
            <div id="spanish-geographic" class="data-content">
                <div class="chart-container">
                    <canvas id="spanishGeographicChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item spanish">
                        <div class="stat-number">#1</div>
                        <div class="stat-label">USA (Most Spanish Learners)</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">#2</div>
                        <div class="stat-label">Germany</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">88%</div>
                        <div class="stat-label">Mexican Spanish Learners from USA</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">46/50</div>
                        <div class="stat-label">US States Where Spanish is #1</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Geographic):</strong></p>
                    <p>Babbel - USA has 4x more Spanish learners than Germany (runner-up)</p>
                    <p>Babbel - 88% of Mexican Spanish learners are in USA</p>
                    <p>Duolingo - Spanish #1 ELL language in 46 of 50 US states + DC</p>
                </div>
            </div>

            <!-- Estimated Data -->
            <div id="spanish-estimated" class="data-content">
                <div class="chart-container">
                    <canvas id="spanishEstimatedChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item spanish">
                        <div class="stat-number">~50%</div>
                        <div class="stat-label">Estimated English Speakers (USA dominated)</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">~15%</div>
                        <div class="stat-label">Estimated German Speakers</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">~35%</div>
                        <div class="stat-label">Other European + Asian Languages</div>
                    </div>
                    <div class="stat-item spanish">
                        <div class="stat-number">Combined</div>
                        <div class="stat-label">Duolingo + Geographic Data</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Estimation Method:</strong></p>
                    <p>Combined Duolingo native language data (42% English speakers) with Babbel geographic data (USA dominance)</p>
                    <p>Adjusted for USA = 85% English + 10% heritage Spanish + 5% other</p>
                    <p>Germany data = 95% German speakers, UK = 90% English, France = 90% French</p>
                </div>
            </div>
        </div>

        <!-- ENGLISH CONTENT -->
        <div id="english-lang" class="language-content">
            <!-- Sub Tabs for Data Sources -->
            <div class="sub-tabs">
                <button class="sub-tab active" onclick="showDataSource('english', 'duolingo')">üìä Duolingo Data</button>
                <button class="sub-tab" onclick="showDataSource('english', 'geographic')">üåé Geographic</button>
                <button class="sub-tab" onclick="showDataSource('english', 'estimated')">üîÆ Estimated</button>
            </div>

            <!-- Duolingo Data -->
            <div id="english-duolingo" class="data-content active">
                <div class="chart-container">
                    <canvas id="englishDuolingoChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item english">
                        <div class="stat-number">1.5B+</div>
                        <div class="stat-label">Total English Learners Worldwide</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">#1</div>
                        <div class="stat-label">India: Most Duolingo English Test Takers</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">400M</div>
                        <div class="stat-label">English Learners in China</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">135</div>
                        <div class="stat-label">Countries Where English is #1 Language Studied</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Duolingo):</strong></p>
                    <p>Duolingo 2024 Language Report, Duolingo English Test Data, British Council</p>
                </div>
            </div>

            <!-- Geographic Data -->
            <div id="english-geographic" class="data-content">
                <div class="chart-container">
                    <canvas id="englishGeographicChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item english">
                        <div class="stat-number">#1</div>
                        <div class="stat-label">India (750+ cities)</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">#2</div>
                        <div class="stat-label">China (850+ cities)</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">#3</div>
                        <div class="stat-label">Canada</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">#4</div>
                        <div class="stat-label">Brazil</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Geographic):</strong></p>
                    <p>Duolingo English Test - India #1, China #2, Canada #3, Brazil #4, Indonesia #5</p>
                    <p>Statista - UK hosts 349k foreign English students, followed by Ireland, Canada, USA, Australia</p>
                </div>
            </div>

            <!-- Estimated Data -->
            <div id="english-estimated" class="data-content">
                <div class="chart-container">
                    <canvas id="englishEstimatedChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item english">
                        <div class="stat-number">~24%</div>
                        <div class="stat-label">Estimated Mandarin/Chinese</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">~21%</div>
                        <div class="stat-label">Estimated Hindi/Indian Languages</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">400M</div>
                        <div class="stat-label">China's Massive English Learning Market</div>
                    </div>
                    <div class="stat-item english">
                        <div class="stat-number">Combined</div>
                        <div class="stat-label">Duolingo + Geographic Data</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Estimation Method:</strong></p>
                    <p>Weighted Duolingo native language data with geographic test-taker rankings</p>
                    <p>China (#2 geographic, 400M learners) = 95% Mandarin + 5% other Chinese languages</p>
                    <p>India (#1 geographic, overtook China) = 75% Hindi + 25% Tamil/Bengali/other regional</p>
                    <p>Adjusted percentages to reflect actual population scales</p>
                </div>
            </div>
        </div>

        <!-- CHINESE CONTENT -->
        <div id="chinese-lang" class="language-content">
            <!-- Sub Tabs for Data Sources -->
            <div class="sub-tabs">
                <button class="sub-tab active" onclick="showDataSource('chinese', 'duolingo')">üìä Duolingo Data</button>
                <button class="sub-tab" onclick="showDataSource('chinese', 'geographic')">üåé Geographic</button>
                <button class="sub-tab" onclick="showDataSource('chinese', 'estimated')">üîÆ Estimated</button>
            </div>

            <!-- Duolingo Data -->
            <div id="chinese-duolingo" class="data-content active">
                <div class="chart-container">
                    <canvas id="chineseDuolingoChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item chinese">
                        <div class="stat-number">100M+</div>
                        <div class="stat-label">Total Chinese Learners Worldwide</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">6M+</div>
                        <div class="stat-label">English Speakers on Duolingo</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">1M</div>
                        <div class="stat-label">Japanese Learning Mandarin</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">30%</div>
                        <div class="stat-label">Cambodia: Highest % of Users Learn Chinese</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Duolingo):</strong></p>
                    <p>Duolingo Special Report, Duolingo 2024 Report, Keats School, CGTN, Holon IQ</p>
                </div>
            </div>

            <!-- Geographic Data -->
            <div id="chinese-geographic" class="data-content">
                <div class="chart-container">
                    <canvas id="chineseGeographicChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item chinese">
                        <div class="stat-number">227k</div>
                        <div class="stat-label">USA K-12 Students (2017)</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">34k</div>
                        <div class="stat-label">France Students (2012)</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">496</div>
                        <div class="stat-label">Confucius Institutes Globally (2023)</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">SE Asia</div>
                        <div class="stat-label">Cambodia, Malaysia, Vietnam Lead</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Data Sources (Geographic):</strong></p>
                    <p>Confucius Institutes - 496 institutes + 757 classrooms in 160 countries (2023)</p>
                    <p>USA - 227k K-12 students, 109 college Confucius Institutes, 347 K-12 classrooms</p>
                    <p>France - 34k students in 2012, Duolingo - Cambodia 30%+, Malaysia, Brunei, Vietnam, Laos follow</p>
                </div>
            </div>

            <!-- Estimated Data -->
            <div id="chinese-estimated" class="data-content">
                <div class="chart-container">
                    <canvas id="chineseEstimatedChart"></canvas>
                </div>
                <div class="stats-grid">
                    <div class="stat-item chinese">
                        <div class="stat-number">~30%</div>
                        <div class="stat-label">Estimated English Speakers</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">~20%</div>
                        <div class="stat-label">Estimated SE Asian Languages</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">~18%</div>
                        <div class="stat-label">Estimated Korean + Japanese</div>
                    </div>
                    <div class="stat-item chinese">
                        <div class="stat-number">Combined</div>
                        <div class="stat-label">Duolingo + Geographic + Heritage</div>
                    </div>
                </div>
                <div class="sources">
                    <p><strong>Estimation Method:</strong></p>
                    <p>Combined Duolingo data (35% English, 6M+ users) with geographic enrollment</p>
                    <p>USA learners = 70% English + 20% heritage Chinese + 10% other</p>
                    <p>SE Asia breakdown: Khmer (Cambodia), Vietnamese, Thai, Malay weighted by population</p>
                    <p>Adjusted for heritage learners in USA/Canada diaspora communities</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================================
        // JAVASCRIPT OVERVIEW
        // ============================================================
        // Manages Chart.js pie chart visualizations and tab switching.
        // Main workflow:
        //   1. On page load ‚Üí initAllCharts() creates all 9 charts
        //   2. User clicks main tab ‚Üí showLanguage() switches language
        //   3. User clicks sub-tab ‚Üí showDataSource() switches data view
        //   4. Chart.js handles rendering, tooltips, legend
        //   5. Fade-in animation on initial load
        // ============================================================

        // ============================================================
        // GLOBAL STATE MANAGEMENT
        // ============================================================
        // charts: Stores Chart.js instances for all 9 charts (3 languages √ó 3 data sources)
        // currentLanguage: Tracks which main tab is active (spanish/english/chinese)
        // currentDataSource: Tracks which sub-tab is active for each language
        // ============================================================
        let charts = {}; // Chart.js instances keyed by canvasId
        let currentLanguage = 'spanish'; // Default to Spanish tab
        let currentDataSource = {
            // Each language remembers its last selected data source
            spanish: 'duolingo',
            english: 'duolingo',
            chinese: 'duolingo'
        };

        // ============================================================
        // DATA STRUCTURE: Chart Data for All Languages
        // ============================================================
        // Three-level nested object:
        //   chartData[language][dataSource] = {labels, data, title}
        //
        // Each dataset contains:
        //   - labels: Array of native language/country names
        //   - data: Array of percentages (must sum to 100)
        //   - title: Chart title displayed above pie chart
        //
        // Data sources explained:
        //   - duolingo: Self-reported native language from Duolingo users
        //   - geographic: Country/region where learners are located
        //   - estimated: Weighted combination accounting for demographics
        // ============================================================
        const chartData = {
            spanish: {
                duolingo: {
                    labels: ['English Speakers', 'Portuguese Speakers', 'French Speakers', 'Italian Speakers', 'German Speakers', 'Chinese Speakers', 'Other Languages'],
                    data: [42, 18, 12, 10, 8, 5, 5],
                    title: 'Spanish Learners by Native Language (Duolingo Data)'
                },
                geographic: {
                    labels: ['USA', 'Germany', 'United Kingdom', 'France', 'Brazil', 'Canada', 'Other Countries'],
                    data: [45, 12, 10, 8, 7, 5, 13],
                    title: 'Spanish Learners by Country/Region (Geographic Data)'
                },
                estimated: {
                    labels: ['English Speakers', 'German Speakers', 'Portuguese Speakers', 'French Speakers', 'Italian Speakers', 'Chinese Speakers', 'Other Languages'],
                    data: [50, 15, 12, 10, 6, 4, 3],
                    title: 'Spanish Learners by Native Language (Estimated)'
                }
            },
            english: {
                duolingo: {
                    labels: ['Hindi/Indian Languages', 'Chinese Speakers (Mandarin)', 'Portuguese Speakers', 'French Speakers', 'Indonesian/Malay Speakers', 'Spanish Speakers', 'Arabic Speakers', 'Japanese Speakers', 'Other Languages'],
                    data: [22, 20, 12, 10, 9, 8, 7, 6, 6],
                    title: 'English Learners by Native Language (Duolingo Data)'
                },
                geographic: {
                    labels: ['India', 'China', 'Canada', 'Brazil', 'Indonesia', 'Japan', 'Other Countries'],
                    data: [26, 24, 12, 11, 9, 6, 12],
                    title: 'English Learners by Country/Region (Geographic Data)'
                },
                estimated: {
                    labels: ['Chinese Speakers (Mandarin)', 'Hindi/Indian Languages', 'Portuguese Speakers', 'French Speakers', 'Indonesian/Malay Speakers', 'Spanish Speakers', 'Arabic Speakers', 'Japanese Speakers', 'Other Languages'],
                    data: [24, 21, 12, 11, 9, 8, 7, 5, 3],
                    title: 'English Learners by Native Language (Estimated)'
                }
            },
            chinese: {
                duolingo: {
                    labels: ['English Speakers', 'Korean Speakers', 'Japanese Speakers', 'Vietnamese Speakers', 'Thai Speakers', 'Khmer Speakers (Cambodian)', 'Malay/Indonesian Speakers', 'French Speakers', 'Other Languages'],
                    data: [35, 18, 12, 10, 8, 5, 5, 4, 3],
                    title: 'Chinese Learners by Native Language (Duolingo Data)'
                },
                geographic: {
                    labels: ['USA', 'France', 'South Korea', 'Japan', 'Cambodia', 'Vietnam', 'Thailand', 'Malaysia', 'Other Countries'],
                    data: [28, 8, 12, 10, 8, 9, 7, 6, 12],
                    title: 'Chinese Learners by Country/Region (Geographic Data)'
                },
                estimated: {
                    labels: ['English Speakers', 'Korean Speakers', 'Japanese Speakers', 'Vietnamese Speakers', 'Thai Speakers', 'Khmer Speakers (Cambodian)', 'Malay/Indonesian Speakers', 'French Speakers', 'Heritage Chinese Speakers', 'Other Languages'],
                    data: [30, 16, 11, 10, 8, 5, 5, 4, 7, 4],
                    title: 'Chinese Learners by Native Language (Estimated)'
                }
            }
        };

        // ============================================================
        // COLOR PALETTE
        // ============================================================
        // Vibrant, distinct colors for pie chart slices.
        // Provides strong visual contrast between segments.
        // Array length supports up to 10 different segments.
        // ============================================================
        const colors = [
            '#FF6384', // Pink/Red
            '#36A2EB', // Blue
            '#FFCE56', // Yellow
            '#4BC0C0', // Teal
            '#9966FF', // Purple
            '#FF9F40', // Orange
            '#C9CBCF', // Gray
            '#FF99CC', // Light Pink
            '#99CCFF', // Light Blue
            '#66FF99'  // Mint Green
        ];

        // ============================================================
        // KEY FEATURE: Chart Creation Factory
        // Core Objective: Create a Chart.js pie chart instance
        // Key Behaviors:
        //   - Accepts canvas ID, data array, labels array, and title
        //   - Configures Chart.js with pie type and custom options
        //   - Returns Chart instance for storage in charts object
        //   - Sets up responsive sizing, legend, and tooltip formatting
        // ============================================================
        function createChart(canvasId, data, labels, title) {
            // Get canvas element by ID
            const ctx = document.getElementById(canvasId);
            if (!ctx) return null; // Canvas not found (shouldn't happen)

            // Create Chart.js pie chart instance
            return new Chart(ctx.getContext('2d'), {
                type: 'pie', // Pie chart type
                data: {
                    labels: labels, // Segment labels (native languages or countries)
                    datasets: [{
                        data: data, // Percentage values
                        backgroundColor: colors.slice(0, data.length), // Slice color array to match data length
                        borderWidth: 3, // White border between slices
                        borderColor: '#fff' // White borders for separation
                    }]
                },
                options: {
                    responsive: true, // Resize with container
                    maintainAspectRatio: false, // Fill container height
                    plugins: {
                        legend: {
                            position: 'right', // Legend on right side
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11,
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: title, // Chart title from data
                            font: {
                                size: 15,
                                weight: 'bold'
                            },
                            padding: 20
                        },
                        tooltip: {
                            callbacks: {
                                // Format tooltip to show percentage
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed + '%'; // Add % symbol
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // ============================================================
        // KEY FEATURE: Initialize All Charts on Page Load
        // Core Objective: Pre-render all 9 charts for instant tab switching
        // Key Behaviors:
        //   - Loops through all languages and data sources
        //   - Creates Chart.js instance for each combination
        //   - Stores instances in charts object for later reference
        //   - Charts remain in DOM but hidden/shown via CSS
        // ============================================================
        function initAllCharts() {
            // Initialize all 9 charts (3 languages √ó 3 data sources)
            Object.keys(chartData).forEach(lang => {
                Object.keys(chartData[lang]).forEach(source => {
                    // Build chart ID: spanishDuolingoChart, englishGeographicChart, etc.
                    const chartId = `${lang}${source.charAt(0).toUpperCase() + source.slice(1)}Chart`;
                    const data = chartData[lang][source];
                    // Create and store chart instance
                    charts[chartId] = createChart(chartId, data.data, data.labels, data.title);
                });
            });
        }

        // ============================================================
        // KEY FEATURE: Switch Main Language Tab
        // Core Objective: Show selected language's content panel
        // Key Behaviors:
        //   - Updates active state on main tab buttons
        //   - Hides all language content panels
        //   - Shows selected language's content panel
        //   - Updates currentLanguage state variable
        // ============================================================
        function showLanguage(language) {
            // Update state
            currentLanguage = language;

            // Remove active class from all main tabs
            document.querySelectorAll('.main-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // Add active class to clicked tab
            event.target.classList.add('active');

            // Hide all language content panels
            document.querySelectorAll('.language-content').forEach(content => {
                content.classList.remove('active');
            });

            // Show selected language's content panel
            document.getElementById(language + '-lang').classList.add('active');
        }

        // ============================================================
        // KEY FEATURE: Switch Data Source Sub-Tab
        // Core Objective: Show selected data source chart within current language
        // Key Behaviors:
        //   - Updates active state on sub-tab buttons (within language panel)
        //   - Hides all data content panels within language
        //   - Shows selected data source's content panel
        //   - Updates currentDataSource state for this language
        // ============================================================
        function showDataSource(language, source) {
            // Update state for this language
            currentDataSource[language] = source;

            // Get the parent language container (scopes sub-tab search)
            const langContainer = document.getElementById(language + '-lang');

            // Remove active class from all sub-tabs within this language
            langContainer.querySelectorAll('.sub-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // Add active class to clicked sub-tab
            event.target.classList.add('active');

            // Hide all data content panels within this language
            langContainer.querySelectorAll('.data-content').forEach(content => {
                content.classList.remove('active');
            });

            // Show selected data source's content panel
            document.getElementById(language + '-' + source).classList.add('active');
        }

        // ============================================================
        // INITIALIZATION
        // ============================================================
        // Runs on page load to set up charts and animations.
        // Workflow:
        //   1. Initialize all 9 Chart.js instances
        //   2. Set container to invisible (opacity 0, slightly down)
        //   3. After 100ms, fade in with smooth transition
        //   4. Creates polished entry animation
        // ============================================================
        document.addEventListener('DOMContentLoaded', function() {
            // Create all Chart.js instances
            initAllCharts();

            // Prepare fade-in animation
            document.querySelector('.container').style.opacity = '0';
            document.querySelector('.container').style.transform = 'translateY(20px)'; // Start 20px down

            // Execute fade-in after brief delay
            setTimeout(() => {
                document.querySelector('.container').style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                document.querySelector('.container').style.opacity = '1'; // Fade to visible
                document.querySelector('.container').style.transform = 'translateY(0)'; // Move to final position
            }, 100);
        });
    </script>
</body>
</html>
