Function Name,What It Does,How It Works,Reusability Score (1-10)
switchLanguage(language),"Switches the active language (Spanish/Chinese/English), saves preference to localStorage, updates MODULE_URLS, and reloads the page to reinitialize with new language modules.","Validates language against MODULE_SETS keys. If valid, calls localStorage.setItem('selected_language', language), updates window.currentLanguage and window.MODULE_URLS from MODULE_SETS[language], logs switch message, then calls window.location.reload() to reinitialize entire application with new modules.",9
getTargetLanguage(),"Returns the target language being learned (e.g., 'chinese', 'spanish', 'english') by reading wordColumns[0] from loaded module metadata.","Checks if window.loadedActMeta exists, iterates through Object.keys(window.loadedActMeta), for each actNum retrieves meta object. If meta.wordColumns exists and has [0] element, returns it lowercased. Returns null if no valid metadata found.",10
toTitleCase(str),"Converts a string to title case (first letter uppercase, rest lowercase).","Returns empty string if input falsy. Otherwise returns str.charAt(0).toUpperCase() + str.slice(1).toLowerCase().",8
validateTargetLanguageConsistency(),"Validates that all loaded modules have the same target language to catch misconfiguration.","Creates Set of languages. Iterates through window.loadedActMeta, extracts wordColumns[0] from each meta, adds lowercased value to Set. If Set.size > 1, logs fatal error listing all languages found and returns false. Returns true if consistent.",7
isChineseMode(),"Checks if the current target language is Chinese (requires special handling for pinyin, rendering, etc.).","Calls getTargetLanguage() and compares result === 'chinese'. Returns boolean.",10
updateChineseModeClass(),"Adds or removes 'chinese-mode' CSS class on document.body based on current target language.","Calls isChineseMode(). If true, calls document.body.classList.add('chinese-mode'), else calls document.body.classList.remove('chinese-mode'). Used for CSS-based styling differences.",8
getTranslationsConfig(),"Returns the translations config object from loaded metadata containing available 'I speak' languages and their column indices.","Iterates through window.loadedActMeta keys, for each actNum checks if meta.translations exists. Returns first found translations object or null if none exists.",10
getDefaultTranslation(),"Returns the default translation language code (e.g., 'english') from loaded metadata.","Iterates through window.loadedActMeta, returns meta.defaultTranslation if found. Returns 'english' as fallback default.",9
getWordColumns(),"Returns the word columns array from loaded metadata (e.g., ['spanish', 'english', 'chinese', 'pinyin', 'portuguese']).","Iterates through window.loadedActMeta, returns meta.wordColumns array if found. Returns null if no metadata loaded.",10
getValidLanguages(),"Returns array of valid 'I speak' language codes from translations config.","Calls getTranslationsConfig(). If result exists, returns Object.keys(translations). Otherwise returns empty array.",9
getTtsLanguageCode(),"Returns the TTS (text-to-speech) language code for the current target language (e.g., 'es-ES', 'zh-CN', 'en-US').","Gets wordColumns[0] from metadata. Uses langMap object mapping language names to full locale codes: spanish→'es-ES', chinese→'zh-CN', english→'en-US', portuguese→'pt-BR', french→'fr-FR', vietnamese→'vi-VN', thai→'th-TH', khmer→'km-KH', indonesian→'id-ID', malay→'ms-MY', filipino→'fil-PH'. Returns mapped code or null.",9
shuffleArray(array),"Fisher-Yates shuffle algorithm. Returns a NEW shuffled array without modifying the original.","Creates shallow copy with [...array]. Iterates from length-1 down to 1, generates random j from 0 to i inclusive, performs ES6 destructuring swap [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]]. Returns shuffled array.",10
combineAndShuffleWords(pack, difficulty),"Combines baseWords and exampleWords with controlled shuffling based on difficulty level. Base words always come first (pedagogical order preserved).","Extracts baseWords and exampleWords arrays from pack object (defaulting to []). Shuffles each array separately using shuffleArray(), then tags each word with type property ('Base Word' or 'Example Word'). Based on difficulty param: 'easy' returns only shuffledBase, 'medium' returns only shuffledExamples, 'hard' (default) returns [...shuffledBase, ...shuffledExamples]. Logs combination stats to console.",10
normalizeChar(char),"Normalizes a single character for typing comparison - removes accents and converts to lowercase.","Returns empty string if char falsy. Otherwise returns char.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, ''). NFD decomposition separates base chars from combining diacritical marks, regex removes the marks. Also aliased to window.normalizeCharForTyping for compatibility.",10
findNextTypingPosition(chars, typedPositions),"Finds the next valid typing position in a word, automatically skipping spaces. Spaces are marked as typed and skipped - users never type spaces.","Iterates through chars array to find first index not in typedPositions Set. If found position is a space, adds it to typedPositions and increments until non-space or end reached. Returns -1 if all positions filled or reached end, otherwise returns next typable position index.",10
checkTypingKey(key, targetChar),"Validates if user's keypress matches the expected character. Returns 'correct', 'wrong', or 'space' (for space keys which are always ignored).","If key === ' ' returns 'space'. Otherwise normalizes both key and targetChar using normalizeChar() and compares. Returns 'correct' if match, 'wrong' otherwise.",10
isWordComplete(chars, typedPositions),"Checks if a word has been completely typed (all non-space characters in typedPositions).","Counts non-space characters using chars.filter(c => c !== ' ').length. Compares against typedPositions.size. Returns true if typedPositions.size >= totalNonSpaceChars.",10
coupleChineseWithPinyin(chinese, pinyin),"Creates 1:1 mapping between Chinese characters and pinyin syllables. Handles Latin letters (ATM, DNA) by mapping each letter to itself.","Returns empty array if either input falsy. Splits pinyin by whitespace into pinyinParts array. Iterates through chinese string char by char. If char matches /[a-zA-Z]/ (Latin), pushes {char, pinyin: char}. Otherwise pushes {char, pinyin: pinyinParts[pinyinIndex++]} using next available syllable. Returns array of coupled objects.",10
renderChineseWithPinyin(coupledArray),"Renders coupled Chinese array as HTML element with character on top and pinyin below each character.","Creates container span with className 'chinese-coupled'. For each {char, pinyin} in array, creates charGroup span with className 'char-group', appends charSpan with className 'chinese-char' containing char, appends pinyinSpan with className 'pinyin' containing pinyin. Appends charGroup to container. Returns container element.",10
renderChineseText(chinese, pinyin),"Convenience function that couples and renders Chinese text in one call.","Calls coupleChineseWithPinyin(chinese, pinyin) to get coupled array, then passes to renderChineseWithPinyin(coupled). Returns resulting HTMLElement.",10
getChineseHtml(chinese, pinyin),"Returns HTML string for Chinese text (useful for innerHTML assignments instead of appendChild).","Calls renderChineseText(chinese, pinyin) to get element, returns element.outerHTML string.",9
saveState(stateObj),"Saves game state object to localStorage under shared STORAGE_KEY.","Wraps localStorage.setItem in try-catch. Calls localStorage.setItem(STORAGE_KEY, JSON.stringify(stateObj)). Logs warning on error but doesn't throw.",10
loadState(),"Loads game state from localStorage and parses JSON.","Wraps localStorage.getItem in try-catch. Gets stored value, if exists calls JSON.parse and returns result. Returns null on error or if nothing stored.",10
toggleDebugMode(),"Toggles DEBUG_MODE flag on/off, shows/hides debug vocabulary table, and updates table content if visible.","Flips window.DEBUG_MODE boolean. Finds debug-vocab-table element by ID. If DEBUG_MODE true, sets display='block' and calls window.updateDebugTable() if exists. If false, sets display='none'. Logs state change. Returns new DEBUG_MODE value.",8
updateDebugTable(options),"Updates the debug vocabulary table with current deck data showing target word, translation, and word type columns.","Exits early if !window.DEBUG_MODE. Supports backwards compatibility - if no options passed, tries to get values from global scope. Gets debugTableBody and debugTableHeader by ID. Updates headers with targetLang and nativeLang labels. Clears tbody. If deck empty, shows 'No deck loaded' message. Gets nativeConfig from translations, determines column indices. Checks if native is Chinese (needs pinyin). Loops through deck, creates tr for each card. Column 1: targetCell with card.spanish/chinese/english. Column 2: nativeCell - if Chinese, couples and renders with pinyin, else shows translation. Column 3: typeCell with card.type or '—'. Appends rows to tbody.",8
initializeDebugUI(),"Creates and appends debug UI elements to DOM including vocabulary table, language selector radio buttons, and simulate buttons.","Returns early if debug-vocab-table already exists. Creates debugContainer div with fixed positioning, black background, monospace font, z-index 9998. Creates title div 'Debug: Current Deck Vocabulary'. Creates languageSelector div with radio buttons for chinese/spanish/english, each with change listener calling switchLanguage(). Creates buttonsContainer with three buttons: 'Right' (calls simulateRight), 'Wrong' (calls simulateWrong), 'Near Victory' (calls simulateNearVictory). Creates table with thead containing header row (id 'debug-table-header-row') and tbody (id 'debug-vocab-tbody'). Creates pronunciationDebug section with title and info div. Injects CSS for table styling. Appends entire debugContainer to document.body.",7
normalizePronunciationText(text, language),"Normalizes text for pronunciation comparison. Handles language-specific normalization like removing spaces and tone marks for Chinese.","Returns empty string if text falsy. Lowercases and trims text. If language === 'chinese', removes all whitespace with replace(/\s+/g, ''), removes tone marks using normalize('NFD').replace(/[\u0300-\u036f]/g, ''). Returns normalized string.",9
getSimilarityThreshold(word),"Returns dynamic similarity threshold based on word length. Shorter words need lower thresholds since they're harder to match perfectly.","Gets word.length. Returns: 0.60 for len<=4, 0.70 for len<=8, 0.75 for len<=12, 0.80 for longer words.",8
levenshteinDistance(str1, str2),"Calculates Levenshtein edit distance between two strings using dynamic programming.","Creates (m+1)x(n+1) DP array initialized with 0s. First row = 0,1,2,...,n (insertions). First column = 0,1,2,...,m (deletions). Fills remaining cells: if chars match dp[i][j] = dp[i-1][j-1], else dp[i][j] = 1 + min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1]). Returns dp[m][n].",9
calculateSimilarity(expected, heard, language),"Calculates similarity percentage between expected and heard text using Levenshtein distance.","Normalizes both strings using normalizePronunciationText(). If equal, returns {score: 100, normalizedExpected, normalizedHeard}. If heard empty, returns score 0. Calculates levenshteinDistance, then similarity = max(0, ((maxLen - distance) / maxLen) * 100). Returns object with score (rounded), normalizedExpected, normalizedHeard.",9
getFeedbackMessage(score),"Returns user-friendly feedback message based on pronunciation score (multi-tier: Perfect, Great, Almost, Try again).","If score >= 90 returns 'Perfect!'. If >= 75 returns 'Great!'. If >= 60 returns 'Almost!'. Otherwise returns 'Try again!'.",8
getScoreClass(score),"Returns CSS class name for score-based coloring (excellent, good, okay, poor).","If score >= 90 returns 'excellent'. If >= 75 returns 'good'. If >= 60 returns 'okay'. Otherwise returns 'poor'.",8
updatePronunciationDebug(debugData),"Updates the pronunciation debug panel with technical details for troubleshooting.","Exits early if !window.DEBUG_MODE. Gets pronunciation-debug-info element by ID. Destructures debugData for languageCode, expected, heard, normalizedExpected, normalizedHeard, score, threshold, passed. Sets innerHTML with formatted debug info including colored pass/fail indicator. Also logs to console.",7
hideFeedback(feedbackElements),"Hides pronunciation feedback overlays by removing 'visible' class from each element.","Iterates through feedbackElements array. For each element, if truthy, calls el.classList.remove('visible').",9
normalizeString(str),"Normalizes a string for comparison - removes spaces, punctuation, and converts to lowercase.","Returns empty string if str falsy. Returns str.toLowerCase().replace(/[\s\.,!?;:'\"()\[\]{}\-_]/g, '') removing all spaces and common punctuation/symbols.",9
generateWrongAnswers(actData, correctAnswer, count),"Generates random wrong answers for multiple choice by collecting all words from entire act, filtering out correct answer, shuffling, and returning first N.","Normalizes correctAnswer using normalizeString(). Creates allWords array. Iterates Object.keys(actData), skips '__actMeta'. For each pack with words array, iterates words, gets column 0 (target language). If not equal to correctAnswer and normalizedWord !== normalizedCorrect, pushes to allWords. Shuffles using inline Fisher-Yates. Returns allWords.slice(0, Math.min(count, allWords.length)).",10
generateWrongAnswersWithPinyin(actData, correctAnswer, count),"Same as generateWrongAnswers but returns objects with both Chinese text AND pinyin for proper coupled rendering.","Gets wordColumns and finds pinyin column index. If no pinyin column, falls back to generateWrongAnswers and maps results to {text, pinyin:''}. Otherwise, same collection logic but pushes {text: chineseText, pinyin: pinyinText} objects. Shuffles and returns slice.",10
showStamp(stampElement, soundFunction, onComplete, duration),"Generic function to show a stamp overlay with sound and auto-hide after duration.","If no stampElement, logs warning and calls onComplete if exists, returns. Adds 'visible' class to stampElement. If soundFunction exists, calls it. Sets setTimeout for duration (default 1500ms) that removes 'visible' class and calls onComplete if exists.",9
showSuccessStamp(stampElement, onComplete),"Shows success stamp (green 'Card Removed') with ding sound.","Calls showStamp(stampElement, playDingSound if exists else null, onComplete).",9
showFailureStamp(stampElement, onComplete),"Shows failure stamp (red 'Extra Practice') with buzz sound.","Calls showStamp(stampElement, playBuzzSound if exists else null, onComplete).",9
loadVoicesForLanguage(languageCode),"Loads TTS voices filtered by language code.","Returns empty array if no languageCode. Gets all voices via speechSynthesis.getVoices(). Filters to voices where v.lang.startsWith(languageCode). Returns filtered array.",9
speakWord(text, options),"Speaks text using Web Speech API TTS with configurable language, voice, and speed.","Returns early if no text. Destructures options with defaults: languageCode='en-US', voice=null, speed=1.0. Creates SpeechSynthesisUtterance with text. Sets utterance.lang, utterance.rate. If voice provided, sets utterance.voice. Calls speechSynthesis.cancel() then speechSynthesis.speak(utterance).",10
findVoiceByURI(voiceURI, voices),"Finds a voice by its URI in an array of voices (for restoring saved voice from localStorage).","Returns null if voiceURI or voices falsy or voices empty. Returns voices.find(v => v.voiceURI === voiceURI) || null.",8
initializeTypingState(targetWord),"Initializes typing state object for a target word with character array, typed positions set, wrong tracking, and initial display.","If no targetWord, returns object with empty chars array, empty Set, empty arrays, 0 wrongAttempts. Otherwise splits targetWord into chars array. Creates typingDisplay by mapping each char: spaces become ' ', others become '_', joined with ' '. Returns {chars, typedPositions: new Set(), wrongPositions: [], wrongAttempts: 0, wrongLetters: [], typingDisplay}.",9
getTypingDisplay(chars, typedPositions),"Generates display string showing typing progress - typed chars shown, untyped shown as underscores, spaces preserved.","Maps over chars array. If position in typedPositions, shows actual char. If char is space, shows space. Otherwise shows underscore. Joins result with ' ' for readability. Returns display string.",9
removeCard(deck, currentIndex),"Removes current card from deck and returns new deck with adjusted index.","If deck empty, returns {deck: [], index: 0}. If deck.length === 1, returns {deck: [], index: 0}. Creates newDeck copy, splices out currentIndex. If newIndex >= newDeck.length, wraps to 0. Returns {deck: newDeck, index: newIndex}.",9
addDuplicateCards(deck, card, count),"Adds duplicate cards to random positions in deck for extra practice.","If deck or card falsy, returns deck or []. Creates newDeck copy. Loops count times (default 2). For each: calculates maxInsertPos as max(1, length-3), randomPos as random 1 to maxInsertPos. Creates duplicate with {...card}, splices into randomPos. Returns newDeck.",9
createDeckFromPack(pack, options),"Initializes deck from pack data by combining words, shuffling based on difficulty, and creating card objects with front/back/type.","Destructures options: targetLang, nativeLang, wordColumns, translations, difficulty. Returns [] if pack or baseWords invalid. Calls combineAndShuffleWords(pack, difficulty). Gets column indices. Checks if target/native is Chinese. Maps combinedWords to card objects with id, rawWord, type. Sets targetWord (with pinyin if Chinese). Sets translation (with pinyin info if Chinese). Returns deck array.",9
populateActSelector(selectElement, loadedActMeta, onChange),"Populates act selector dropdown with options from loaded module metadata.","Returns early with warning if no selectElement. Clears innerHTML. Returns if no loadedActMeta. Gets actNumbers by mapping keys to Numbers, filtering NaN, sorting ascending. For each actNum, gets actName from meta or defaults to 'Act N'. Creates option with value=actNum, textContent='Act N: Name'. If onChange provided, adds change listener that parses value and calls onChange(actNum).",8
populatePackSelector(selectElement, actData, onChange),"Populates wordpack selector dropdown sorted by pack number with titles.","Returns early if no selectElement. Clears innerHTML. Returns if no actData. Gets packKeys filtering out '__actMeta' and packs without meta. Sorts by meta.wordpack number. For each packKey, creates option with value=packKey, textContent='Pack N: Title'. If onChange provided, adds change listener calling onChange(packKey).",8
populateNativeLanguageSelector(selectElement, translations, currentValue, onChange),"Populates 'I speak' language dropdown from translations config with display names.","Returns early if no selectElement. Clears innerHTML. Returns with warning if no translations. Iterates Object.entries(translations). For each [code, config], creates option with value=code, textContent=config.display or code, sets selected if code===currentValue. If onChange provided, adds change listener calling onChange(languageCode).",8
navigateToPrevious(state, callbacks),"Navigates to previous card with wrap-around. Returns new index.","Returns currentIndex if deck empty. Calculates newIndex = (currentIndex - 1 + deck.length) % deck.length. Calls callbacks.onNavigate(newIndex) if exists. Calls setTimeout(() => callbacks.onAutoSpeak(), 300) if onAutoSpeak exists. Returns newIndex.",9
navigateToNext(state, callbacks),"Navigates to next card with wrap-around. Returns new index.","Returns currentIndex if deck empty. Calculates newIndex = (currentIndex + 1) % deck.length. Calls callbacks.onNavigate(newIndex) if exists. Calls setTimeout(() => callbacks.onAutoSpeak(), 300) if onAutoSpeak exists. Returns newIndex.",9
resetDeckToOriginal(originalDeck, callbacks),"Resets deck to original state without shuffling (preserves pedagogical order).","Returns {deck: [], currentIndex: 0} if originalDeck empty. Creates newDeck as shallow copy [...originalDeck]. Calls callbacks.onReset(newDeck) if exists. Returns {deck: newDeck, currentIndex: 0}.",9
navigateToNextPack(wordpacks, currentPackKey),"Navigates to next wordpack in sequence with wrap-around.","Gets packs array from Object.keys(wordpacks). If empty returns currentPackKey. Finds currentPackIndex using indexOf. Calculates nextPackIndex = (currentPackIndex + 1) % packs.length. Returns packs[nextPackIndex].",9
setTTSSpeed(speed, speedButtons),"Sets TTS speech speed and updates button active states.","Removes 'active' class from all speedButtons. Finds button where parseFloat(btn.dataset.speed) === speed or getAttribute matches. If found, adds 'active' class. Returns speed value.",9
renderTypingDisplayHTML(typingDisplay, typedPositions, wrongPositions),"Renders typing display as HTML string with word grouping, typed characters, and wrong position styling.","Builds html string. Iterates through typingDisplay by index. If space, wraps accumulated currentWord chars in nowrap span, adds to html, resets currentWord. If typed position, creates span with typing-char class and wrongClass. If untyped, creates span with invisible char and underscore overlay. After loop, wraps remaining currentWord. Returns html string.",9
renderTargetWordHTML(card, isChineseTarget),"Renders target word with Chinese+pinyin if applicable.","If isChineseTarget and card.pinyin exists, returns getChineseHtml(card.targetWord, card.pinyin). Otherwise returns card.targetWord or empty string.",9
renderTranslationHTML(card),"Renders translation with Chinese+pinyin if applicable.","If card.translationIsChinese and card.translationPinyin exists, returns getChineseHtml(card.translation, card.translationPinyin). Otherwise returns card.translation or empty string.",9
createButtonTooltip(button, htmlContent),"Creates tooltip element for a button with HTML content.","Returns if no button. Finds and removes existing .btn-tooltip child. Creates span with className 'btn-tooltip', sets innerHTML to htmlContent. Appends to button.",10
updateWordpackTitleDisplay(titleElement, packKey, wordpacks),"Updates wordpack title display element with pack number and title.","Returns if no titleElement. If packKey exists in wordpacks, gets pack, extracts packNum from meta.wordpack, packTitle from meta.english. Sets titleElement.textContent to 'Lesson N. Title'. Otherwise clears textContent.",8
simulateCorrectAnswer(deck, currentIndex, onSuccess),"Debug function: Simulates correct answer by removing current card.","Returns {deck: [], currentIndex: 0} if deck empty. Creates newDeck copy. If length <= 1, calls onSuccess if exists, returns empty. Splices currentIndex, adjusts newIndex if past end, calls onSuccess, returns {deck: newDeck, currentIndex: newIndex}.",9
simulateWrongAnswer(deck, currentIndex, duplicateCount, onFailure),"Debug function: Simulates wrong answer by adding duplicate cards to end.","Returns {deck: [], currentIndex: 0} if deck empty. Creates newDeck copy, gets currentCard. Loops duplicateCount (default 2) times, pushes {...currentCard} copies. Calculates newIndex = (currentIndex + 1) % newDeck.length. Calls onFailure if exists. Returns {deck: newDeck, currentIndex: newIndex}.",9
simulateNearVictory(deck, onSimulate),"Debug function: Sets deck to just the last card for testing victory state.","Returns {deck: [], currentIndex: 0} if deck empty. Gets lastCard from deck[length-1]. Creates newDeck = [lastCard]. Calls onSimulate if exists. Returns {deck: newDeck, currentIndex: 0}.",9
getAudioContext(),"Creates or returns singleton Web Audio API AudioContext for sound generation.","Checks if audioContext module variable is null. If so, creates new AudioContext using window.AudioContext || window.webkitAudioContext constructor. Returns audioContext (creates once, reuses thereafter).",10
playTypingSound(),"Plays satisfying mechanical keyboard click sound for typing feedback. Plays on EVERY keypress (both correct and wrong).","Gets AudioContext. Creates very short duration buffer (0.015-0.025s). Generates click noise with sharp decay envelope (Math.pow decay). Creates bandpass filters: bp1 at 2000-3500Hz for mechanical click, bp2 at 1000-1500Hz for body. Creates highpass at 400Hz to remove mud. Sets gain 0.35-0.45 with random variation. Connects audio chain source→hp→bp1→bp2→gain→destination. Starts source.",10
handleTypingInput(wordIndex, correctWord, key, inputElement),"Handles keypress during typing practice. Manages per-word typing state, validates input, tracks wrong attempts.","Gets or creates typingState from state.typingStates Map for wordIndex. Splits correctWord into chars. Calls playTypingSound(). If key is space, returns (spaces ignored). Finds nextPos by iterating to first untyped position. Skips spaces (marks as typed). Normalizes key and target char. If match, adds position to typedPositions. If wrong, pushes to wrongLetters, increments wrongCount. Calls updateTypingDisplay if exists.",10
resetListeningState(recordButton),"Resets speech recognition listening state. DRY helper called from multiple places.","Sets global isListening to false if defined. Sets global currentListeningWordIndex to null if defined. Sets recordButton.textContent to mic emoji if button exists.",9
startListeningForPronunciation(wordIndex, correctWord, recordButton),"Starts speech recognition for pronunciation practice with scoring.","Checks recognition exists, alerts if not supported. Returns if already listening. Sets isListening true, currentListeningWordIndex to wordIndex. Sets recognition.lang from SPEECH_LANG_CODES. Sets button to red emoji. Sets recognition.onresult handler that iterates results finding best match via calculateSimilarity, stores result in state.pronunciationStates, calls resetListeningState and updatePronunciationDisplay. Sets onerror handler for no-speech and not-allowed cases. Sets onend to resetListeningState. Calls recognition.start().",10
restoreSavedState(),"Restores and validates saved state from localStorage. Returns true if state restored.","Calls loadState(). Returns false if no saved state. Validates saved.currentLanguage against VALID_LANGUAGES. Validates and restores act, pack, nativeLanguage. Validates nativeLanguage column against LANGUAGE_CONFIG columns. Restores mode booleans (multipleChoiceMode, typingMode, pronunciationMode, flashcardMode). Restores showChineseChars and showPinyin. Returns true.",9
validateAndFixState(),"Validates restored state against loaded data. Nullifies invalid act/pack for auto-selection.","Returns if state undefined. If state.currentAct not in state.loadedData, logs warning and sets to null. If state.currentPack not in actData, logs warning and sets to null. These nulls trigger autoSelectFirstActAndPack later.",8
loadLanguageData(languageName),"Loads all act modules for a specific language asynchronously.","Calls updateDebugInfo if exists. Gets config from LANGUAGE_CONFIG. Clears state.loadedData and state.loadedActMeta. Loops through config.modules array. For each moduleInfo, calls await decodeObfuscatedModule(path). Extracts __actMeta to state.loadedActMeta[act]. Stores remaining pack data in state.loadedData[act]. Logs success/failure for each act.",9
initFlashcardDeck(),"Initializes flashcard deck from current wordpack using anti-decoupling architecture (front and back stored as properties of same object).","Resets state.flashcardDeck, flashcardIndex, flashcardShowingFront. Gets pack from state.loadedData[currentAct][currentPack]. Calls combineAndShuffleWords(pack). Gets nativeIndex from state.currentNativeLanguage. Checks if learning Chinese (for frontPinyin). Checks if native is Chinese (for backPinyin). Maps words to card objects with id, front (word[0]), back (word[nativeIndex]), type. Adds pinyin properties if applicable. Logs deck size.",9
flipCard(),"Toggles between front and back of current flashcard.","Returns if state undefined or deck empty. Flips state.flashcardShowingFront boolean. Calls updateFlashcardDisplay() if exists.",8
nextCard(),"Moves to next card in flashcard deck with wrap-around. Shows front.","Returns if deck empty. Calculates flashcardIndex = (index + 1) % length. Sets flashcardShowingFront = true. Calls updateFlashcardDisplay() if exists.",8
prevCard(),"Moves to previous card in flashcard deck with wrap-around. Shows front.","Returns if deck empty. Calculates flashcardIndex = (index - 1 + length) % length. Sets flashcardShowingFront = true. Calls updateFlashcardDisplay() if exists.",8
shuffleDeck(),"Fisher-Yates shuffles flashcard deck. Anti-decoupling benefit: entire card objects move together.","Returns if deck empty. Fisher-Yates loop: for i from length-1 to 1, random j from 0 to i, swap deck[i] and deck[j] using destructuring. Resets flashcardIndex = 0 and flashcardShowingFront = true. Calls updateFlashcardDisplay() if exists. Logs completion message.",9
autoSelectFirstActAndPack(),"Auto-selects first available act and pack. DRY encapsulated function called from multiple places.","Returns if state undefined or loadedData empty. Finds firstAct as Math.min of numeric keys. Sets state.currentAct. Updates actSelect element value if exists. Calls populatePackDropdown if exists. Gets firstPackKey from first act data. Sets state.currentPack. Updates packSelect element value if exists. Calls displayVocabulary if exists. Calls saveState if exists.",7
