Function Name,What Does It Do (Very Detailed),How Does It Work (Very Detailed),Reusability Score (1-10)
showStartingCard,"Displays the main menu/settings card as an overlay on top of the game content. The menu allows users to select Act, Wordpack, native language ('I speak'), pronunciation speed, and voice. This menu card uses the same flashcard UI styling as game cards, maintaining visual consistency. When activated, it shows menu controls on the front side and help/instructions on the back side. The menu acts as an overlay - game content remains loaded underneath and is visible when the menu is toggled off. This function can optionally flip to the back side immediately (when showBack=true) to display help instructions.","First saves the current card index to savedIndex so we can return to it later. Sets isOnStartingCard flag to true. Adds 'showing-menu' CSS class to both the flashcard element and body (makes nav buttons and card counter visible even in menu mode). Updates the wordpack title to show game title based on detected target language (e.g. 'Spanish Flashcard Typing Game'). Updates card counter text to 'Choose Lesson to Begin Studying'. Calls renderMenuCard() to populate the front and back of the card with menu HTML. Unflips the card if currently flipped. If showBack parameter is true, schedules a flipCard() call after 100ms to show the help side immediately.",6
exitStartingCard,"Returns from the menu/settings card back to the current flashcard at the saved position. This allows users to open the menu, change settings, and return to exactly where they were in their study session without losing progress. The function removes the menu overlay and restores the game state.","Checks if we're actually on the starting card (isOnStartingCard), returns early if not. Sets isOnStartingCard to false. Removes 'showing-menu' CSS class from both flashcard element and body. Restores currentIndex from savedIndex (the position we saved when showing menu). Calls updateWordpackTitleDisplay() to restore the actual wordpack title (not the menu title). Calls updateDisplay() to render the current flashcard.",7
renderMenuCard,"Generates and renders the complete menu card HTML for both front (settings) and back (help) sides. The front side contains all game configuration options: Act selector, Wordpack selector, native language ('I speak') selector, pronunciation speed buttons, voice selector, and a 'Start Game' button. The back side contains comprehensive help instructions explaining all four game modes (Flashcard, Spelling, Pronunciation, Translation) and all controls (keyboard shortcuts and button functions). After rendering the HTML, this function populates all dropdowns with actual data and attaches event listeners to all interactive elements.","First determines language name for UI text (uses targetLanguageDisplay or fallback to 'Target'). Sets up descriptive text for typing modes (for Chinese it's 'type pinyin', otherwise 'type what you heard' or 'type [language] translation'). Generates HTML for front side containing: Act dropdown, Wordpack dropdown, Language dropdown, Speed buttons (üê¢/üö∂/üêá for slow/medium/fast), Voice dropdown, and Start button - all styled with menu-specific CSS classes. Generates HTML for back side containing help text with all mode descriptions and control instructions. Sets both spanishWord.innerHTML and englishWord.innerHTML to their respective content. Uses setTimeout 0ms to ensure HTML is rendered before populating dropdowns. Then populates Act selector using window.populateActSelector() with loadedActMeta. Handles Act dropdown change by loading new act data and repopulating Wordpack selector. Populates Wordpack selector by calling populateWordpackSelectorOnCard(). Populates Language selector using window.populateNativeLanguageSelector() from translations config. Populates Voice dropdown with available TTS voices, restoring saved voice if found. Sets up Speed button click handlers with active state highlighting. All dropdowns call saveState() when changed. Start button calls startGame() when clicked.",4
switchMode,"Switches between the four learning modes: flashcard (reading), spelling (listening), pronunciation (speaking), and translation (writing). Each mode has different UI behavior and different card display logic. This function completely resets the current wordpack deck to its original state (preserving pedagogical ordering of base words before example words) without reshuffling, resets the card index to 0, updates the active mode button styling, unflips any flipped cards, resets deck change indicators, and auto-pronounces the first word if entering spelling mode.","Checks if newMode equals currentMode - returns early if already in that mode (no work needed). Stops any playing speech sounds using speechSynthesis.cancel(). Sets currentMode to newMode. Updates active button styling by removing 'active' class from all mode buttons, then adding it to the newly selected mode button. Completely resets the deck by copying originalDeck to currentDeck without shuffling - this preserves the pedagogical ordering (base words first, then example words). Sets currentIndex to 0 (start from first card). Checks if card is flipped and unflips it if so. Resets pendingDeckChange to 0 (clears any pending deck size change indicators). For spelling or translation modes, calls initializeTypingDisplay() to set up blank typing state. Calls updateDisplay() to render the card in new mode. If new mode is spelling, schedules speakTargetWord() after 300ms to auto-pronounce (helps user learn through listening repetition). Calls updateSimulateButtonsVisibility() if it exists (for debug mode). Calls saveState() to persist the mode change.",10
populateVoiceSelector,"DEPRECATED function kept for backwards compatibility. Voice selector population is now handled inside renderMenuCard() function. This function does nothing - it's an empty stub.","Does nothing. Returns immediately. Kept to prevent errors if old code still calls this function.",2
initializeTooltips,"Initializes all tooltip content in the UI from the single source of truth (TOOLTIP_MESSAGES object from wordpack-logic.js). This function populates BOTH the mode selector button tooltips (the instruction lists that appear below each mode button) AND the control bar button tooltips (hover text for individual action buttons like Got It, Confused, Pronounce, Peek, Record). All tooltips use the exact same message strings from TOOLTIP_MESSAGES to ensure consistency across the UI - if a message changes in one place, it changes everywhere.","For each mode (Flashcard, Spelling, Pronunciation, Translation), finds the corresponding tooltip element by ID (e.g. 'tooltip-reading', 'tooltip-listening'). For each tooltip, builds an HTML string containing: mode title (e.g. 'üìñ Flashcard Mode'), followed by a div with class 'tooltip-instructions' containing the relevant TOOLTIP_MESSAGES strings joined with <br> tags. For Flashcard mode includes: gotIt, confused, prevCard, nextCard, pronounce, peek. For Spelling mode includes: typeLetters, pronounce, peek. For Pronunciation mode includes: record, pronounce, peek. For Translation mode includes: typeLetters, pronounce, peek. Then populates control bar button tooltips by setting innerHTML to button icons and setAttribute('data-tooltip-html', message) for each button: gotItBtn gets ‚úì and TOOLTIP_MESSAGES.gotIt, confusedBtn gets ‚úó and confused message, pronounceBtn gets üó£Ô∏è and pronounce message, peekBtn gets ‚ùì and peek message, micBtnControl gets üé§ and record message.",9
initializeApp,"Main initialization function that runs on page load. This function loads all act modules to get their metadata (act names, translations, word columns), validates that all modules have the same target language, detects which language is being learned (Spanish/Chinese/English), applies language-specific CSS (Chinese mode styling), loads TTS voices for the detected language, restores any saved user state from localStorage (last selected act/wordpack/settings), preloads deck content from the saved or default wordpack so there's content under the menu when it displays, sets game-started state so UI elements are visible, and finally displays the menu card as an overlay on top of the preloaded content.","Shows loading message. If MODULE_URLS has entries, sets currentAct to 1 (first act). Loops through all acts (1 to MODULE_URLS.length) and calls loadAct() for each to load all act metadata. Calls validateTargetLanguageConsistency() to ensure all modules agree on target language - throws error if inconsistent. Calls getTargetLanguage() to detect target language from loaded modules (returns 'spanish', 'chinese', or 'english'). Converts to title case for display (e.g. 'Spanish'). Calls updateChineseModeClass() to apply 'chinese-mode' CSS class to body if needed. Updates document.title and page title to include detected language name. Logs detected language to console. Calls loadVoices() to load TTS voices for the detected language. Remembers firstAct (the initially loaded act). Calls restoreSavedState() to load saved user preferences from localStorage (may change currentAct, currentWordpackKey, nativeLanguage, etc.). If saved act differs from firstAct, loads the saved act. If currentWordpackKey is not set, defaults to first pack in current act. If a valid wordpack is selected, calls initializeDeck() to load cards, updateWordpackTitleDisplay() to show pack title, updateBackLabel() to show translation language. Sets game-started CSS classes on flashcard and body. Sets gameStarted flag to true. Finally calls showStartingCard(false) to display menu overlay on top of loaded content. If any error occurs, catches it and shows error message in menu dropdowns.",9
updateBackLabel,"DEPRECATED function that used to update the card back label with the translation language name. Card labels have been removed from the design, so this function now does nothing or performs minimal operations. Kept for backwards compatibility with existing code that calls it.","Checks if backLabel element exists, returns early if not. Gets translations config from loaded module metadata. Returns early if no translations config. Gets language config for current nativeLanguage from translations. Sets backLabel.textContent to the display name from language config, or falls back to default translation display name if not found.",3
generateWeathering,"Generates random CSS gradient patterns to create a weathered, aged paper effect on flashcards. Each card gets a unique but consistent weathering pattern based on its card ID (used as random seed). The weathering includes: subtle color variation splotches across the entire card (simulating age discoloration), stronger sun-faded edges (darker borders that vary in intensity), and randomized brown/sepia tones. Using a seed ensures the same card always looks the same (doesn't change on every render), while different cards have different patterns. The function returns a comma-separated string of CSS gradient definitions ready to be assigned to background CSS property.","Uses card ID as seed for consistent pseudo-random number generation. Defines nested random() helper function that uses Math.sin(seed) to generate deterministic random values between 0 and 1. Generates top/right/bottom/left fade percentages (15-25% range) using random values - these control how far the edge darkening extends. Generates RGB tint values for brownish/sepia tones: red 101-120, green 67-82, blue 33-43. Generates edge intensity (0.18-0.30) for how dark the edges are. Generates overall intensity (0.03-0.07) for subtle color variation. Generates random positions (X/Y percentages) for three color variation splotches. Builds array of gradient strings: three radial gradients for color variation splotches at random positions using the tint colors at low opacity, four linear gradients (one per edge) for sun-faded effect at higher opacity. Joins all gradients with commas and returns the string. This string is then assigned to element's style.background property.",2
updateDisplay,"The master display function that renders the current flashcard based on the current mode (flashcard/spelling/pronunciation/translation). This function is called whenever the card content needs to update: after navigation, after mode switch, after deck changes, etc. It handles all mode-specific rendering: flashcard mode shows target word front / translation back, spelling mode shows typing input / shows answer on back, pronunciation mode shows target word / translation, translation mode shows translation / typing input. The function also updates the card counter (format depends on mode), shows/hides wrong attempt indicators, applies random weathering effects, manages which control buttons are visible, and resets flip state.","First checks if isOnStartingCard is true (we're showing menu) - returns early without changing card content if so. If currentDeck is empty (pack completed), shows completion screen with celebration emoji, completion message, and two buttons (Study Again / Next Pack) - returns. Gets the current card object: card = currentDeck[currentIndex] (CRITICAL: single object ensures front/back always linked). Determines counter text format: flashcard mode shows 'Card X of Y', other modes show 'Y Cards Left'. Updates cardCounter.textContent. Gets reference to wrong indicator elements (wrongLettersFront, wrongCountFront). Mode-specific rendering: FLASHCARD mode sets spanishWord to renderTargetWordHTML() (handles Chinese coupling), sets englishWord to translation with renderTranslationHTML(), clears wrong indicators. SPELLING mode sets wrongLettersFront to display all wrong letters with stored rotation/scale transforms and red X overlays, sets wrongCountFront to show penalty count with random rotation/scale, sets spanishWord to typing display with renderTypingDisplayHTML(), sets englishWord to show target word + translation. TRANSLATION mode sets wrong indicators same as spelling, sets spanishWord to translation + typing display, sets englishWord to target word. PRONUNCIATION mode sets spanishWord to target word, sets englishWord to translation, clears wrong indicators. Shows/hides mic button in control bar based on mode (visible in pronunciation only). Shows/hides Got It/Confused buttons (visible in flashcard only). Shows/hides control separator (visible in flashcard and pronunciation). Shows/hides nav arrows (visible in flashcard only - other modes auto-advance). Generates weathering pattern using card.id as seed, applies to both front and back weathering elements. Removes 'flipped' class and sets isFlipped to false (resets card to front side).",5
unflipCard,"Unflips the flashcard to show the front side. Unlike flipCard which stops speech, this function intentionally does NOT stop speech - allows pronunciation to continue while viewing the front of card. This is used for 'peek' behavior where user holds a button to temporarily see the back, then releases to return to front while audio keeps playing.","Removes 'flipped' CSS class from flashcard element. Sets isFlipped flag to false. Does NOT call speechSynthesis.cancel() - speech continues playing.",8
showFeedback,"Displays pronunciation feedback after speech recognition completes. Shows the similarity score (percentage match), feedback message (Perfect!/Great!/Good!/Try Again), what the system heard, and the expected word. In pronunciation mode (speaking practice), this function also handles auto-advancing behavior: scores >= threshold (70%) remove the card and show success stamp, scores < threshold add 2 penalty cards and advance to next card after delay. In non-pronunciation modes, it simply shows a feedback overlay that user can close manually.","Takes parameters: score (percentage 0-100), heard (what speech recognition detected), expected (the correct word), isFront (boolean for which card side). Gets appropriate feedback elements based on isFront flag (feedbackFront/feedbackBack, etc.). Calculates dynamic threshold based on word length using getSimilarityThreshold(). If currentMode is 'pronunciation' (speaking practice mode): checks if score >= threshold - if passing, sets pendingDeckChange to -1, calls updateDisplay(), then calls showSuccessStamp() with callback that removes the card from deck (handles last card case), resets pendingDeckChange to 0, plays card flip sound, calls updateDisplay() and saveState(). If failing (score < threshold), uses addDuplicateCards() to add 2 penalty cards, updates currentDeck and currentIndex, then schedules moveToNextCard() after 1600ms. Returns early without showing overlay. If NOT pronunciation mode: sets scoreEl text to percentage, sets scoreEl class based on getScoreClass(), sets messageEl to getFeedbackMessage(), sets heardEl to show what was heard, adds 'visible' class to feedback overlay.",7
startGame,"Begins or resumes a practice session with the selected wordpack. This function is called when user clicks 'Start Game' button in menu. It handles two scenarios: (1) Starting fresh - initializes and shuffles a new deck if game hasn't started yet, deck is empty, or wordpack changed. (2) Resuming - if deck is already loaded for the current wordpack, simply restores the saved card position and continues where user left off without reshuffling. This preserves user progress when toggling menu on/off. After setup, it exits menu mode, makes game UI visible, and saves state.","First calls updateBackLabel() to update translation language display. Calls updateWordpackTitleDisplay() to show current wordpack title. Sets isOnStartingCard to false. Removes 'showing-menu' class from flashcard and body. Determines if a new deck is needed by checking three conditions: (!gameStarted) game not started yet, OR (currentDeck.length === 0) no deck exists, OR (deck exists but first card's ID doesn't start with currentWordpackKey) wordpack changed. If needsNewDeck is true, calls initializeDeck(currentWordpackKey) to create and shuffle new deck. If needsNewDeck is false (resuming), sets currentIndex to savedIndex (returns to where user was) and calls updateDisplay(). Adds 'game-started' class to flashcard and body (makes game UI visible). Sets gameStarted flag to true. Calls saveState() to persist current state.",10
simulateRight,"Debug function that simulates a correct answer for testing purposes. This allows developers to quickly test the 'card removed' flow without actually completing the card. It removes the current card from the deck (same behavior as getting a correct answer in any mode), plays success sound, updates the display, and logs the action. This function is exposed globally (window.simulateRight) so debug UI buttons can call it. Uses shared simulateCorrectAnswer() function from wordpack-logic.js for the core logic.","Checks if currentDeck is empty - returns early if so (can't simulate on no cards). Plays ding sound using playDingSound(). Calls simulateCorrectAnswer() from wordpack-logic.js passing currentDeck, currentIndex, and callback function. The callback: re-initializes typing display if in spelling or translation mode, calls updateDisplay(), saveState(), updateDebugTable(), and logs debug message. Updates currentDeck and currentIndex from the result object returned by simulateCorrectAnswer().",10
simulateWrong,"Debug function that simulates a wrong answer for testing purposes. This allows developers to quickly test the 'add penalty cards' flow without actually making mistakes. It adds 2 duplicate cards to the deck (same behavior as getting a wrong answer in typing or pronunciation modes), plays failure sound, updates the display, and logs the action. This function is exposed globally (window.simulateWrong) so debug UI buttons can call it. Uses shared simulateWrongAnswer() function from wordpack-logic.js for the core logic.","Checks if currentDeck is empty - returns early if so. Plays buzz sound using playBuzzSound(). Calls simulateWrongAnswer() from wordpack-logic.js passing currentDeck, currentIndex, penalty count (2), and callback function. The callback: re-initializes typing display if in spelling or translation mode, calls updateDisplay(), saveState(), updateDebugTable(), and logs debug message. Updates currentDeck and currentIndex from the result object returned by simulateWrongAnswer().",10
simulateNearVictory,"Debug function that simulates a 'near victory' state - reduces deck to only 1 card (the last card). This allows developers to quickly test the end-game experience and victory screen without playing through an entire wordpack. Useful for testing completion UI, next pack navigation, and study again functionality. This function is exposed globally (window.simulateNearVictory) so debug UI buttons can call it. Uses shared simulateNearVictory() function from wordpack-logic.js for the core logic.","Checks if currentDeck length is 0 - returns early if deck is empty (nothing to simulate). Plays button click sound using playButtonClickSound(). Calls simulateNearVictory() from wordpack-logic.js passing currentDeck and callback function (no count parameter - function always reduces to 1 card). The callback: re-initializes typing display if in spelling or translation mode, calls updateDisplay(), saveState(), updateDebugTable(), and logs debug message. Updates currentDeck and currentIndex from the result object returned by simulateNearVictory().",10
