<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wordpack Data Structure Debugger</title>

  <!--
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                                                              â•‘
    â•‘   ğŸ® LANGUAGE LEARNING GAME - REFERENCE TEMPLATE IMPLEMENTATION ğŸ®           â•‘
    â•‘                                                                              â•‘
    â•‘   This file serves as the CANONICAL REFERENCE for all language learning     â•‘
    â•‘   games in this project. It demonstrates 100% compliance with our design    â•‘
    â•‘   principles and should be used as a template for building new games.       â•‘
    â•‘                                                                              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    ============================================================
    TABLE OF CONTENTS
    ============================================================
    1. DESIGN PRINCIPLES OVERVIEW
    2. DATA STRUCTURE ARCHITECTURE
    3. STATE PERSISTENCE (localStorage)
    4. DRY (Don't Repeat Yourself) PATTERNS
    5. KEY FEATURES DOCUMENTATION
    6. COLUMN MAPPING BY LANGUAGE
    7. HOW TO USE THIS TEMPLATE

    ============================================================
    1. DESIGN PRINCIPLES OVERVIEW
    ============================================================

    This project follows strict design principles to ensure maintainability,
    consistency, and ease of development. ALL games must follow these rules:

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PRINCIPLE 1: KEY FEATURES ARE SACRED                                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ - Every important feature MUST have a KEY FEATURE comment block        â”‚
    â”‚ - KEY FEATURES document: Core Objective + Key Behaviors                â”‚
    â”‚ - KEY FEATURES can NEVER be removed without explicit user request      â”‚
    â”‚ - Code can change, but the FEATURE must be preserved                   â”‚
    â”‚                                                                        â”‚
    â”‚ FORMAT:                                                                â”‚
    â”‚   // ============================================================     â”‚
    â”‚   // KEY FEATURE: [High-level description]                            â”‚
    â”‚   // Core Objective: [Why this feature exists]                        â”‚
    â”‚   // Key Behaviors:                                                   â”‚
    â”‚   //   - [Behavior 1 that must be preserved]                          â”‚
    â”‚   //   - [Behavior 2 that must be preserved]                          â”‚
    â”‚   // ============================================================     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PRINCIPLE 2: DRY (Don't Repeat Yourself) - ENCAPSULATION               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ - NEVER copy-paste the same code in multiple places                    â”‚
    â”‚ - If something happens together, put it in ONE function                â”‚
    â”‚ - Ask: "If I needed to change this, how many places would I update?"   â”‚
    â”‚ - If answer > 1, you need to encapsulate                               â”‚
    â”‚                                                                        â”‚
    â”‚ EXAMPLES IN THIS FILE:                                                 â”‚
    â”‚   - autoSelectFirstActAndPack(): Called from 2 places                  â”‚
    â”‚   - setupModeCheckboxes(): Config-driven, not 3 separate functions     â”‚
    â”‚   - resetListeningState(): Used in 3 event handlers                    â”‚
    â”‚   - normalizeCharForTyping(): Single function for accent removal       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PRINCIPLE 3: STATE PERSISTENCE (localStorage) - MANDATORY              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ - ALL user-configurable settings MUST be saved to localStorage         â”‚
    â”‚ - On page load, restore saved state (or use sensible defaults)         â”‚
    â”‚ - User should return to EXACTLY where they left off                    â”‚
    â”‚ - Validate saved values against current valid options                  â”‚
    â”‚                                                                        â”‚
    â”‚ WHAT MUST BE SAVED:                                                    â”‚
    â”‚   - Language selection (Spanish, Chinese, English)                     â”‚
    â”‚   - Act selection                                                      â”‚
    â”‚   - Pack selection                                                     â”‚
    â”‚   - Native language ("I speak") selection                              â”‚
    â”‚   - Mode toggles (multiple choice, typing, pronunciation)              â”‚
    â”‚   - Any other user preference                                          â”‚
    â”‚                                                                        â”‚
    â”‚ WHEN TO SAVE:                                                          â”‚
    â”‚   - On ANY menu/setting change                                         â”‚
    â”‚   - Call saveState() immediately after state change                    â”‚
    â”‚                                                                        â”‚
    â”‚ VALIDATION RULE:                                                       â”‚
    â”‚   - Always validate saved values against current valid options         â”‚
    â”‚   - If saved value is invalid, fall back to default                    â”‚
    â”‚   - This prevents bugs when options change between versions            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PRINCIPLE 4: SINGLE SOURCE OF TRUTH (Configuration Objects)            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ - All configuration lives in JavaScript objects, NOT hardcoded HTML    â”‚
    â”‚ - Dropdowns are EMPTY in HTML, populated from config                   â”‚
    â”‚ - If you delete the config, NOTHING should work                        â”‚
    â”‚                                                                        â”‚
    â”‚ IN THIS FILE:                                                          â”‚
    â”‚   - LANGUAGE_CONFIG: All module paths, columns, native languages       â”‚
    â”‚   - VALID_MODES: List of valid mode options for validation             â”‚
    â”‚   - HTML dropdowns: Empty <select></select> elements                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ============================================================
    2. DATA STRUCTURE ARCHITECTURE
    ============================================================

    Our language learning data follows a hierarchical structure:

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         DATA HIERARCHY                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                        â”‚
    â”‚   LANGUAGE (Spanish, Chinese, English)                                 â”‚
    â”‚       â”‚                                                                â”‚
    â”‚       â””â”€â”€ ACT (Learning Stage - e.g., "Foundation", "Daily Life")      â”‚
    â”‚             â”‚                                                          â”‚
    â”‚             â””â”€â”€ WORDPACK (Vocabulary Set - e.g., "Greetings")          â”‚
    â”‚                   â”‚                                                    â”‚
    â”‚                   â”œâ”€â”€ META (Pack metadata: number, titles)             â”‚
    â”‚                   â”‚                                                    â”‚
    â”‚                   â””â”€â”€ WORDS (Array of word arrays)                     â”‚
    â”‚                         â”‚                                              â”‚
    â”‚                         â””â”€â”€ WORD (Array of translations by column)     â”‚
    â”‚                                                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    OBFUSCATED MODULE STRUCTURE (NEW - with baseWords/exampleWords separation):
    Each .js module exports a dictionary of wordpacks:

    {
      "p{act}_{pack}_{name}": {
        "meta": {
          "wordpack": 1,                    // Pack number (integer)
          "english": "Greetings & Goodbyes", // Pack title in English
          "chinese": "é—®å€™è¯­",                // Pack title in Chinese
          "spanish": "Saludos y Despedidas", // Pack title in Spanish
          ... // Other language translations as supported
        },
        "baseWords": [
          ["base1_col0", "base1_col1", "base1_col2", ...],  // Core vocabulary
          ["base2_col0", "base2_col1", "base2_col2", ...],
          ["base3_col0", "base3_col1", "base3_col2", ...]
        ],
        "exampleWords": [
          ["example1_col0", "example1_col1", "example1_col2", ...],  // Usage examples
          ["example2_col0", "example2_col1", "example2_col2", ...],
          ["example3_col0", "example3_col1", "example3_col2", ...]
        ]
      },
      "p{act}_{pack}_{name}": { ... },
      ...
    }

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    ğŸ¯ CRITICAL ARCHITECTURE DESIGN ğŸ¯                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                          â”‚
    â”‚  WHY WE SEPARATE baseWords AND exampleWords:                            â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
    â”‚                                                                          â”‚
    â”‚  Learning Pedagogy: Core vocabulary (base words) should be learned      â”‚
    â”‚  BEFORE contextual examples. This separation allows:                    â”‚
    â”‚                                                                          â”‚
    â”‚  1. BASE WORDS FIRST: Essential vocabulary without context              â”‚
    â”‚     Example: ["hola", "adiÃ³s", "gracias"]                              â”‚
    â”‚                                                                          â”‚
    â”‚  2. EXAMPLES SECOND: Real-world usage with context                      â”‚
    â”‚     Example: ["hola amigo", "adiÃ³s mi amor", "muchas gracias"]         â”‚
    â”‚                                                                          â”‚
    â”‚  3. CONTROLLED RANDOMIZATION:                                           â”‚
    â”‚     - Shuffle baseWords internally â†’ random order within base words    â”‚
    â”‚     - Shuffle exampleWords internally â†’ random order within examples   â”‚
    â”‚     - Concatenate: [shuffled_base] + [shuffled_examples]               â”‚
    â”‚     - Result: Base vocabulary ALWAYS appears before examples,           â”‚
    â”‚       but both sections are randomized for variety                      â”‚
    â”‚                                                                          â”‚
    â”‚  This prevents learners from seeing "hola amigo" before learning "hola" â”‚
    â”‚  while still providing randomization within each category.              â”‚
    â”‚                                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    CRITICAL: Column 0 is ALWAYS the target language being learned!

    ============================================================
    3. STATE PERSISTENCE (localStorage) - IMPLEMENTATION
    ============================================================

    Every game MUST implement these functions:

    const STORAGE_KEY = 'uniqueGameNameState';  // Unique per game

    function saveState() {
      const stateToSave = {
        language: state.currentLanguage,
        act: state.currentAct,
        pack: state.currentPack,
        nativeLanguage: state.currentNativeLanguage,
        // ... all other user settings
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(stateToSave));
    }

    function loadState() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        return saved ? JSON.parse(saved) : null;
      } catch (e) {
        console.error('Failed to load state:', e);
        return null;
      }
    }

    function restoreSavedState() {
      const saved = loadState();
      if (!saved) return;

      // ALWAYS validate before restoring!
      if (saved.language && VALID_LANGUAGES.includes(saved.language)) {
        state.currentLanguage = saved.language;
      }
      // ... validate and restore other settings
    }

    ============================================================
    4. DRY PATTERNS - EXAMPLES IN THIS FILE
    ============================================================

    PATTERN 1: Encapsulated Helper Functions
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    PROBLEM: Same 5 lines of code in 2+ places
    SOLUTION: Extract to named function, call from both places

    Example: autoSelectFirstActAndPack()
    - Used in: initialize(), setupLanguageRadioButtons()
    - Benefit: Change logic in ONE place

    PATTERN 2: Configuration-Driven Loops
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    PROBLEM: 3 separate functions doing almost the same thing
    SOLUTION: One function with config array

    Example: setupModeCheckboxes()
    - Config: [{ id, stateKey, statesToClear }, ...]
    - One loop handles all checkboxes identically
    - Add new checkbox = add to config array

    PATTERN 3: Callback Parameters
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    PROBLEM: Same action with different follow-up
    SOLUTION: Function takes callback parameter

    Example: showSuccessStamp(onComplete)
    - Stamp + sound + delay always happen together
    - What happens AFTER varies
    - Pass the variation as callback

    ============================================================
    5. KEY FEATURES IN THIS FILE
    ============================================================

    Search for "KEY FEATURE:" to find all documented features:

    1. Global State Management - Single source of truth for UI state
    2. State Persistence (localStorage) - Save/restore user settings
    3. Module Decoding - 3-layer obfuscation (base64 + zlib + reverse)
    4. Auto-Select First Act/Pack - DRY encapsulated function
    5. Language Selection - Switch between target languages
    6. Mode Checkboxes - DRY config-driven setup
    7. Speech Recognition - Pronunciation practice with scoring
    8. Multiple Choice Generation - Act-wide pool, duplicate filtering
    9. Typing Practice - Character-by-character with accent tolerance
    10. Vocabulary Table Display - Multi-mode rendering
    11. Flashcard Mode - ANTI-DECOUPLING DEMONSTRATION (front/back always linked)

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PRINCIPLE 5: ANTI-DECOUPLING (Critical for Flashcard Games)            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Related data must be stored as properties of the SAME object,          â”‚
    â”‚ never in separate arrays that could get out of sync.                   â”‚
    â”‚                                                                        â”‚
    â”‚ âŒ WRONG (Decoupled - leads to bugs):                                  â”‚
    â”‚    const fronts = ["hola", "adiÃ³s"];                                   â”‚
    â”‚    const backs = ["hello", "goodbye"];                                 â”‚
    â”‚    // Problem: Arrays can get out of sync!                             â”‚
    â”‚                                                                        â”‚
    â”‚ âœ… RIGHT (Anti-decoupled - always safe):                               â”‚
    â”‚    const cards = [                                                     â”‚
    â”‚      { front: "hola", back: "hello" },                                 â”‚
    â”‚      { front: "adiÃ³s", back: "goodbye" }                               â”‚
    â”‚    ];                                                                  â”‚
    â”‚    // Benefit: front and back are ALWAYS linked!                       â”‚
    â”‚                                                                        â”‚
    â”‚ See "Flashcard Mode" for a live demonstration.                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ============================================================
    6. COLUMN MAPPING BY LANGUAGE
    ============================================================

    SPANISH (5 columns):
      [0] = Spanish (TARGET - language being learned)
      [1] = English
      [2] = Chinese
      [3] = Pinyin
      [4] = Portuguese

    CHINESE (12 columns):
      [0] = Chinese (TARGET - language being learned)
      [1] = Pinyin
      [2] = English
      [3] = Spanish
      [4] = French
      [5] = Portuguese
      [6] = Vietnamese
      [7] = Thai
      [8] = Khmer
      [9] = Indonesian
      [10] = Malay
      [11] = Filipino

    ENGLISH (5 columns):
      [0] = English (TARGET - language being learned)
      [1] = Chinese
      [2] = Pinyin
      [3] = Spanish
      [4] = Portuguese

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CRITICAL: CHINESE + PINYIN INSEPARABILITY                               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Notice that ALL three languages include Chinese AND Pinyin columns!    â”‚
    â”‚                                                                        â”‚
    â”‚ WHY: Chinese uses logograms (characters don't encode pronunciation)    â”‚
    â”‚      â†’ Pinyin MUST accompany Chinese whenever it appears               â”‚
    â”‚                                                                        â”‚
    â”‚ This applies whether Chinese is:                                       â”‚
    â”‚   - The target language (ChineseWords CSVs)                           â”‚
    â”‚   - A translation option (SpanishWords, EnglishWords CSVs)            â”‚
    â”‚                                                                        â”‚
    â”‚ EDGE CASE: Latin Abbreviations in Chinese Text                         â”‚
    â”‚ When Chinese contains Latin (ATM, DNA, WhatsApp, etc.):               â”‚
    â”‚   - Latin sequence â†’ same in pinyin (case insensitive)                â”‚
    â”‚   - Chinese characters â†’ pinyin syllables (1:1 mapping)               â”‚
    â”‚                                                                        â”‚
    â”‚ Examples:                                                              â”‚
    â”‚   Chinese: ATMæœº      â†’ Pinyin: ATM jÄ«                                â”‚
    â”‚   Chinese: DNAæµ‹è¯•     â†’ Pinyin: DNA cÃ¨ shÃ¬                            â”‚
    â”‚   Chinese: WhatsAppæ¶ˆæ¯ â†’ Pinyin: WhatsApp xiÄo xÄ«                    â”‚
    â”‚   Chinese: Tæ¤        â†’ Pinyin: T xÃ¹                                  â”‚
    â”‚                                                                        â”‚
    â”‚ Use "Show Edge Cases" checkbox below to filter for these examples.    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ============================================================
    7. HOW TO USE THIS TEMPLATE
    ============================================================

    To create a new game based on this template:

    1. Copy this file as your starting point
    2. Change STORAGE_KEY to unique value for your game
    3. Keep all KEY FEATURE implementations
    4. Keep all DRY helper functions
    5. Keep localStorage save/restore pattern
    6. Add your game-specific features with KEY FEATURE comments
    7. Follow the same documentation style

    CHECKLIST FOR NEW GAMES:
    â–¡ Unique STORAGE_KEY defined
    â–¡ saveState() called on every setting change
    â–¡ loadState() called during initialization
    â–¡ Saved values validated against valid options
    â–¡ All KEY FEATURES documented with comment blocks
    â–¡ No copy-pasted code (use encapsulated functions)
    â–¡ Configuration objects as single source of truth
    â–¡ Empty HTML dropdowns, populated from JS config

    ============================================================
  -->

  <!--
    ============================================================
    PAKO.JS DEPENDENCY - Required for decompressing obfuscated modules
    ============================================================
    Our obfuscated modules use zlib compression (via pako library).
    This CDN script provides the pako.inflate() function for decompression.
  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
  <!-- Shared wordpack logic (loading, decoding, shuffling, typing validation) -->
  <script src="./wordpack-logic.js"></script>

  <style>
    /* Fixed Header */
    body {
      margin: 0;
      padding-top: 180px; /* Space for fixed header */
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    .decoder-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(180deg, rgba(61, 46, 31, 0.95) 0%, rgba(61, 46, 31, 0.92) 100%);
      padding: 15px 20px;
      z-index: 1000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      color: #fff;
    }

    .decoder-header h1 {
      margin: 0 0 8px 0;
      font-size: 1.4rem;
      color: #E8C252;
    }

    .header-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .control-group label {
      font-size: 0.75rem;
      color: #D4AF37;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .control-group select {
      padding: 6px 10px;
      border-radius: 4px;
      border: 1px solid #666;
      background: rgba(255,255,255,0.95);
      font-size: 0.9rem;
    }

    .mode-selector {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.2);
    }

    .mode-selector label {
      cursor: pointer;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 5px;
      color: rgba(232,196,82,0.9);
      transition: color 0.2s;
    }

    .mode-selector label:hover {
      color: #E8C252;
    }

    .mode-selector input[type="radio"] {
      accent-color: #D4AF37;
    }

    .content-container {
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
  </style>
</head>
<body>

  <!-- Fixed Header with All Controls -->
  <div class="decoder-header">
    <h1>Wordpack Data Structure Debugger</h1>
    <div class="header-controls">
      <!-- Language Selection -->
      <div class="control-group">
        <label>Target Language</label>
        <div id="languageRadios" style="display: flex; gap: 10px; margin-top: 5px;">
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="Spanish" checked> Spanish
          </label>
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="Chinese"> Chinese
          </label>
          <label style="font-size: 0.85rem; color: #fff; text-transform: none;">
            <input type="radio" name="language" value="English"> English
          </label>
        </div>
      </div>

      <!-- Act Selection -->
      <div class="control-group">
        <label for="actSelect">Act</label>
        <select id="actSelect"></select>
      </div>

      <!-- Pack Selection -->
      <div class="control-group">
        <label for="packSelect">Wordpack</label>
        <select id="packSelect"></select>
      </div>

      <!-- Native Language -->
      <div class="control-group">
        <label for="nativeLanguageSelect">I Speak</label>
        <select id="nativeLanguageSelect"></select>
      </div>
    </div>

    <!-- Mode Selector (Radio Buttons) -->
    <div class="mode-selector">
      <label><input type="radio" name="viewMode" value="table" checked> Table</label>
      <label><input type="radio" name="viewMode" value="multipleChoice"> Multiple Choice</label>
      <label><input type="radio" name="viewMode" value="typing"> Typing</label>
      <label><input type="radio" name="viewMode" value="pronunciation"> Pronunciation</label>
      <label><input type="radio" name="viewMode" value="flashcard"> Flashcard</label>
    </div>
  </div>

  <!-- Content Container -->
  <div class="content-container">

  <!-- Vocabulary Table Section -->
  <h2>Vocabulary Table</h2>
  <p><strong>Pack Title:</strong> <span id="packTitle">Select a wordpack to view</span></p>

  <!--
    ============================================================
    VOCABULARY TABLE - With Optional Multiple Choice Mode
    ============================================================
    Displays the selected wordpack's vocabulary.

    BASIC MODE (Default):
    - 2 columns: Target language (column 0) and Native language (selected)

    MULTIPLE CHOICE MODE (Checkbox enabled):
    - 6 columns total:
      1. Target language (correct answer, column 0)
      2. Native language translation (column N)
      3-6. Four wrong answers (randomly selected from ENTIRE ACT, ~2,500 words)

    WRONG ANSWER POOL:
    Wrong answers are now pulled from ALL wordpacks in the current act,
    not just the current wordpack. This provides:
    - Greater variety (2,500 options vs 50)
    - Less predictable patterns
    - Better simulation of real game mechanics
    - Zero performance cost (all data already loaded in memory)

    DUPLICATE FILTERING:
    Uses normalized string comparison (lowercase, no spaces/symbols)
    to avoid showing essentially identical words:
    - "hola" vs "Hola" (case difference) - filtered
    - "hello friend" vs "hellofriend" (spacing) - filtered
    - "hello!" vs "hello" (punctuation) - filtered

    This demonstrates the CORE LOGIC for generating multiple choice questions
    used in language learning games. Different game mechanics require different
    numbers of choices:
    - Temple Run style: 3 choices (1 correct + 2 wrong)
    - Quiz games: 4 choices (1 correct + 3 wrong)
    - This demo: 6 choices (1 correct + 4 wrong) to show extensibility

    The algorithm works for ANY target language (Spanish, Chinese, English, etc.)
    and ANY future language packs we add to the system.

    NOTE: Mode selection is now in the fixed header above (radio buttons).
  -->

  <!--
    ============================================================
    EDGE CASES & MISMATCHES FILTER - Combined Filter
    ============================================================
    When enabled, filters the vocabulary table to show words with:

    1. EDGE CASES - Latin abbreviations/brand names in Chinese text:
       - ATMæœº â†’ ATM jÄ« (Latin block + Chinese character)
       - DNAæµ‹è¯• â†’ DNA cÃ¨ shÃ¬ (abbreviation + Chinese)
       - WhatsAppæ¶ˆæ¯ â†’ WhatsApp xiÄo xÄ« (brand name + Chinese)
       - Tæ¤ â†’ T xÃ¹ (single letter + Chinese)
       - la, los â†’ la, los (Spanish articles in Chinese column)

    2. PINYIN MISMATCHES - Words with "?" in pinyin (CSV data errors):
       - Character count doesn't match syllable count
       - Indicates validation failures that need fixing

    WHY THIS IS USEFUL:
    - See real examples of edge cases in the actual data
    - Identify pinyin errors that need surgical fixes
    - Verify edge cases are NOT validation errors (they're correct!)
    - Understand how Latin text mixes with Chinese in modern usage
  -->
  <p id="edgeCaseFilterContainer" style="display: none;">
    <label>
      <input type="checkbox" id="showEdgeCasesOnly">
      <strong>Show Edge Cases & Mismatches</strong> (Latin abbreviations + pinyin errors)
    </label>
  </p>

  <!--
    ============================================================
    FLASHCARD MODE CHECKBOX
    ============================================================
    When enabled, shows a simple flashcard interface demonstrating
    the CRITICAL anti-decoupling principle:

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ANTI-DECOUPLING PRINCIPLE (CRITICAL FOR FLASHCARD GAMES)               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                        â”‚
    â”‚ âŒ WRONG WAY (Decoupled - leads to bugs):                              â”‚
    â”‚    const fronts = ["hola", "adiÃ³s", "gracias"];                        â”‚
    â”‚    const backs  = ["hello", "goodbye", "thank you"];                   â”‚
    â”‚    // Problem: If arrays get out of sync, flipping shows WRONG answer  â”‚
    â”‚    // Bug: fronts[2] might display backs[1] if something shifts        â”‚
    â”‚                                                                        â”‚
    â”‚ âœ… RIGHT WAY (Anti-decoupled - front/back ALWAYS linked):              â”‚
    â”‚    const cards = [                                                     â”‚
    â”‚      { front: "hola",    back: "hello" },      // Card 0               â”‚
    â”‚      { front: "adiÃ³s",   back: "goodbye" },    // Card 1               â”‚
    â”‚      { front: "gracias", back: "thank you" }   // Card 2               â”‚
    â”‚    ];                                                                  â”‚
    â”‚    // Benefit: cards[i].front and cards[i].back are ALWAYS paired      â”‚
    â”‚    // Shuffling reorders cards but NEVER breaks the link               â”‚
    â”‚                                                                        â”‚
    â”‚ WHY THIS MATTERS:                                                      â”‚
    â”‚   - Flipping a card ALWAYS shows the correct translation               â”‚
    â”‚   - Shuffling the deck doesn't break anything                          â”‚
    â”‚   - Adding/removing cards can't cause misalignment                     â”‚
    â”‚   - The card is ONE OBJECT, not two separate arrays                    â”‚
    â”‚                                                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    This mode demonstrates the principle with a minimal, no-CSS implementation.

    NOTE: Flashcard mode is now in the fixed header above (radio button).
  -->

  <!--
    ============================================================
    FLASHCARD DISPLAY AREA (Simple, No CSS)
    ============================================================
    This is intentionally unstyled to focus on the DATA STRUCTURE,
    not the visual presentation. The key teaching point is HOW
    front and back are stored as ONE object, not two arrays.
  -->
  <div id="flashcardArea" style="display: none; margin: 20px 0; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
    <h3>Flashcard Demo (Anti-Decoupling Principle)</h3>
    <p><em>Front and back are properties of the SAME card object - they can never get out of sync.</em></p>

    <!-- Card display - simple border box -->
    <div id="flashcardDisplay" style="border: 3px solid #666; padding: 40px; margin: 20px 0; text-align: center; min-height: 150px; background: white; cursor: pointer;" onclick="window.flipCard()">
      <div id="flashcardContent" style="font-size: 24px;">Click to start</div>
      <div id="flashcardSide" style="font-size: 12px; color: #999; margin-top: 10px;">(click card to flip)</div>
    </div>

    <!-- Navigation buttons - plain HTML buttons -->
    <div style="text-align: center;">
      <button onclick="window.prevCard()" style="padding: 10px 20px; margin: 5px;">â† Previous</button>
      <button onclick="window.flipCard()" style="padding: 10px 20px; margin: 5px;">Flip Card</button>
      <button onclick="window.nextCard()" style="padding: 10px 20px; margin: 5px;">Next â†’</button>
      <button onclick="window.shuffleDeck()" style="padding: 10px 20px; margin: 5px;">ğŸ”€ Shuffle</button>
    </div>

    <!-- Card counter -->
    <p id="flashcardCounter" style="text-align: center; margin-top: 10px;">Card 0 of 0</p>

    <!-- Debug: Show current card object structure -->
    <details style="margin-top: 20px;">
      <summary style="cursor: pointer; font-weight: bold;">ğŸ” View Current Card Object (Anti-Decoupling Proof)</summary>
      <pre id="flashcardDebug" style="background: #eee; padding: 10px; overflow-x: auto; font-size: 12px;">
// No card loaded yet
      </pre>
      <p style="font-size: 12px; color: #666;">
        â†‘ Notice: <code>front</code> and <code>back</code> are properties of the SAME object.<br>
        They cannot get out of sync because they're not stored in separate arrays.
      </p>
    </details>
  </div>

  <table border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr id="tableHeaderRow">
        <th id="col1Header">I am learning</th>
        <th id="col2Header">I speak</th>
      </tr>
    </thead>
    <tbody id="vocabularyTable">
      <tr>
        <td colspan="2">Loading data...</td>
      </tr>
    </tbody>
  </table>

  <hr>

  <!--
    ============================================================
    DEBUG INFORMATION
    ============================================================
    Shows technical details about loaded data for debugging purposes.
  -->
  <h2>6. Debug Information</h2>
  <pre id="debugInfo">Initializing...</pre>

  <!--
    ============================================================
    JAVASCRIPT MODULE - Main Logic
    ============================================================
    All JavaScript logic has been moved to DecoderTest.js
    This includes:
    1. Decoding obfuscated modules (3-layer: base64 + zlib + string reversal)
    2. Loading language data automatically on page load
    3. Populating dropdowns dynamically
    4. Displaying vocabulary in 2-column table
    5. Handling user interactions (language/act/pack/native language changes)
  -->
  <script type="module" src="./DecoderTest.js"></script>

  </div> <!-- End content-container -->

</body>
</html>
